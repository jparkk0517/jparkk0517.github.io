<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({&#x27;gtm.start&#x27;:
new Date().getTime(),event:&#x27;gtm.js&#x27;});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!=&#x27;dataLayer&#x27;?&#x27;&amp;l=&#x27;+l:&#x27;&#x27;;j.async=true;j.src=
&#x27;https://www.googletagmanager.com/gtm.js?id=&#x27;+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,&#x27;script&#x27;,&#x27;dataLayer&#x27;,&#x27;GTM-K5DKF9QN&#x27;);</script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.5.0/github-markdown-light.min.css" integrity="sha512-Pmhg2i/F7+5+7SsdoUqKeH7UAZoVMYb1sxGOoJ0jWXAEHP0XV2H4CITyK267eHWp2jpj7rtqWNkmEOw1tNyYpg==" crossorigin="anonymous" referrerPolicy="no-referrer"/><meta property="og:type" content="website"/><meta property="og:url" content="https://jparkk0517.github.io"/><meta property="og:title" content="ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ tkdodo blog ê¸€ ë²ˆì—­"/><meta property="og:description" content="ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ê³µì‹ ì‚¬ì´íŠ¸ì— ìˆëŠ” ë¸”ë¡œê·¸ ê¸€ì„ ìŠ¤í„°ë””í•˜ì—¬ ê³µìœ "/><meta name="next-head-count" content="8"/><link rel="preload" href="/_next/static/css/be776103873f57cf.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/be776103873f57cf.css" crossorigin="" data-n-g=""/><link rel="preload" href="/_next/static/css/5c3da54741072322.css" as="style" crossorigin=""/><link rel="stylesheet" href="/_next/static/css/5c3da54741072322.css" crossorigin="" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" crossorigin="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-2d438e3c13b38a7e.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/framework-550f72cae410482c.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/main-e6e0b507836a963c.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/_app-4aaadabc7e07a81c.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/346-c3d964f55d703767.js" defer="" crossorigin=""></script><script src="/_next/static/chunks/pages/posts/%5BpostId%5D-298b5756e6baa490.js" defer="" crossorigin=""></script><script src="/_next/static/Orm4NPDinx5N5dWCEtNLl/_buildManifest.js" defer="" crossorigin=""></script><script src="/_next/static/Orm4NPDinx5N5dWCEtNLl/_ssgManifest.js" defer="" crossorigin=""></script></head><body><div id="__next"><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-K5DKF9QN" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="h-screen"><div class="navbar bg-base-100 sticky top-0 z-10"><div class="flex-1"><a class="btn btn-ghost text-xl">SunBlog</a></div><div class="flex-none gap-2"><div class="form-control"><div class="join"><div><div><input class="input input-sm input-bordered join-item max-w-[30vw]" placeholder="" value=""/></div></div><select class="select select-bordered join-item select-sm"><option value="tag">í‚¤ì›Œë“œ</option><option value="title" selected="">ì œëª©</option></select><div class="indicator"><button class="btn join-item btn-sm">ì¡°íšŒ</button></div></div></div></div></div><main class="prose p-4 align-baseline overflow-y-scroll h-[85vh]"><div class="mb-20"><div class="hero bg-base-300"><div class="hero-content text-center"><div class="max-w-md"><h1 class="text-5xl font-bold">ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ tkdodo blog ê¸€ ë²ˆì—­</h1><p class="my-4">2024.01.28</p><div class="max-w-[80vw] break-words mb-4">ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ê³µì‹ ì‚¬ì´íŠ¸ì— ìˆëŠ” ë¸”ë¡œê·¸ ê¸€ì„ ìŠ¤í„°ë””í•˜ì—¬ ê³µìœ </div><div class="badge badge-outline ">react query</div><div class="badge badge-outline ">ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬</div></div></div></div><div class="divider"></div><article class="markdown-body min-h-[58vh]"><div><p>Apollo Clientì˜ ë“±ì¥ìœ¼ë¡œ fetch library( ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬ )ê°€ reduxì™€ ê°™ì€ ì „ì—­ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤ëŠ” ì˜ê²¬ì´ í™•ì‚°ë˜ì—ˆë‹¤.</p>
<h1># 1. ì‹¤ìš©ì  ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬</h1>
<blockquote>
<p>í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ VS ì„œë²„ ìƒíƒœ</p>
</blockquote>
<p>ApolloëŠ” data fetching ë¿ë§Œ ì•„ë‹ˆë¼ ì„œë²„ì—ì„œ ë³´ë‚¸ ë°ì´í„°( fetchingí•´ì˜¨ ì„œë²„ ë°ì´í„° )ì— ëŒ€í•œ ìºì‹œ ê¸°ëŠ¥ê¹Œì§€ ì œê³µí•œë‹¤. ì¦‰ useQuery hookì„ ì‚¬ìš©í•˜ì—¬ fetchingí•œ í›„ ìºì‹±ëœ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ Componentì—ì„œ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.</p>
<p>ì´ì „ì˜ í´ë¼ì´ì–¸íŠ¸ ì•±ë“¤ì€ ì„œë²„ì˜ ìƒíƒœ( í‘œì‹œí•˜ê³ ì í•˜ëŠ” ë°ì´í„° )ë¥¼ ì†Œìœ í•˜ì§€ ì•Šê³ , ê°€ì¥ ìµœì‹ ì˜ ìë£Œë¥¼ ê°€ì ¸ì™€ì„œ í‘œì¶œí•˜ëŠ”ë° ê·¸ì¹˜ê³  ìˆì—ˆë‹¤. í•­ìƒ ë°ì´í„°ì˜ ì†Œìœ ìëŠ” ì„œë²„ì˜€ë‹¤.</p>
<blockquote>
<p>React-Query</p>
</blockquote>
<p>ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” Fronet-endë‹¨ì—ì„œë„ data fetchingê³¼ loading, error stateë¥¼ í¬í•¨í•œ ìƒíƒœ ì „ì—­ì„ ë‹¨ìˆœí•˜ê²Œ ê´€ë¦¬í•˜ë„ë¡ í•˜ê³ ì í–ˆë‹¤. REST apiì²˜ëŸ¼</p>
<p>react-queryëŠ” refetchOnWindowFocusë¥¼ í†µí•´ ë‹¤ë¥¸ ì°½ì— ê°”ë˜ focusê°€ ë‹¤ì‹œ ëŒì•„ì˜¤ë©´ ì„œë²„ì— ë°ì´í„°ë¥¼ ìš”ì²­í•˜ì—¬ ìµœì‹ ìƒíƒœì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íŠ¸ë¦¬ê±°ëœ Componentì˜ í‘œì¶œëœ ë°ì´í„°ê°€ ë³€ê²½ë˜ë©° ì´ ëª¨ë“  ê³¼ì •ì€ loading spinnerê°€ ì—†ì´ ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</p>
<ol>
<li>StaleTime: query dataê°€ ìµœì‹ (fresh) â†’ ì˜¤ë˜ëœ(stale)ìƒíƒœê°€ ë˜ëŠ”ë° ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ëœ»í•©ë‹ˆë‹¤. ì¿¼ë¦¬ì˜ ë°ì´í„°ê°€ ìµœì‹ ì´ë¼ê³  íŒë‹¨ë  ê²½ìš° í•­ìƒ cacheì— ìˆëŠ” ë°ì´í„°ë§Œì„ í‘œì¶œí•˜ë„ë¡ í•©ë‹ˆë‹¤( ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì—†ì´ )</li>
<li>CacheTime: ë¹„í™œì„± ì¿¼ë¦¬ê°€ ìºì‹œì—ì„œ ì œê±° ë ë•Œê¹Œì§€ì˜ ì‹œê°„ì„ ëœ»í•©ë‹ˆë‹¤(default = 5min). í•´ë‹¹ ì¿¼ë¦¬ì— ë“±ë¡ëœ ê´€ì°°ì(observer)ê°€ ì—†ëŠ” ê²½ìš° ì¦‰ì‹œ ì¿¼ë¦¬ê°€ ë¹„í™œì„± ìƒíƒœê°€ ë©ë‹ˆë‹¤.</li>
</ol>
<p>â‡’ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° staleTimeì„ ì¡°ì •í•˜ë„ë¡í•˜ê³ , cacheTimeì€ ì¡°ì •í•  í•„ìš”ê°€ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤.</p>
<h1># 2. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ ë°ì´í„° ë³€í™˜</h1>
<blockquote>
<p>ë°ì´í„°ì˜ ë³€í™˜</p>
</blockquote>
<p>RESTë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ë•Œ, í™”ë©´ì— í‘œì¶œí•˜ê¸° ìœ„í•œ í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ê°€ê³µí•  ìˆ˜ ìˆëŠ” ì§€ì ì€ 3 + 1êµ°ë°ê°€ ì¡´ì¬í•œë‹¤.</p>
<ol>
<li>back-end ( +1ì— í•´ë‹¹í•˜ë©° front-endì˜ ë‹´ë‹¹ì´ ì•„ë‹Œ êµ¬ì—­)<ol>
<li>ë°±ì—”ë“œë‹¨ì—ì„œ ì• ì´ˆì— í•„ìš”í•œ ë°ì´í„° í˜•íƒœë¡œ ê°€ê³µí•˜ì—¬ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ì£¼ëŠ” ë°©ë²•</li>
<li>ì¥ì <ol>
<li>í‘œì¶œì— ì™„ì „íˆ ë¶€í•©í•˜ëŠ” í˜•íƒœ ê·¸ëŒ€ë¡œ ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.</li>
</ol>
</li>
<li>ë‹¨ì <ol>
<li>í”„ë¡ íŠ¸ì•¤ë“œì˜ ì˜ì—­ì´ ì•„ë‹ˆë‹¤</li>
</ol>
</li>
</ol>
</li>
<li>queryFn<ol>
<li>useQuery(${QUERY_KEY}, ${queryFn})<ol>
<li>ì—¬ê¸°ì„œ queryFnì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ì—¬ cacheì— ì €ì¥í•  ìˆ˜ ìˆë‹¤.</li>
</ol>
</li>
<li>ì¥ì <ol>
<li>ë°ì´í„° ì²˜ë¦¬ ìœ„ì¹˜ê°€ ë°±ì—”ë“œì— ê°€ê¹ë‹¤ ( front-end component â†”Â cache â†”Â back-end )</li>
</ol>
</li>
<li>ë‹¨ì <ol>
<li>fetchingì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ queryFnì—ì„œ ê°€ê³µí•˜ì—¬ cacheì— ì €ì¥í•˜ë¯€ë¡œ ì›ë˜ fetchingí•´ì˜¨ ë°ì´í„° ì›í˜•ì„ ë‚˜ì¤‘ì— ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ì—†ë‹¤.</li>
</ol>
</li>
</ol>
</li>
<li>Render<ol>
<li>react component renderë‹¨ìœ„ì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ë°©ë²•</li>
<li>ì¥ì <ol>
<li>useMemoë¥¼ í†µí•´ ìµœì í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.</li>
</ol>
</li>
<li>ë‹¨ì <ol>
<li>ë°ì´í„°ì˜ ì •í™•í•œ êµ¬ì¡°ë¥¼ devtoolsë¥¼ í†µí•´ í™•ì¸í•˜ê¸°ê°€ ì–´ë µë‹¤</li>
<li>êµ¬ë¬¸ì´ ë³µì¡í•˜ë‹¤</li>
</ol>
</li>
</ol>
</li>
<li>ì„ íƒ ì˜µì…˜<ol>
<li>useQuery( ${QUERY_KEY}, ${queryFn}, ${select_option} )ì—ì„œ select_option ê°ì²´ì—ì„œ selectí”„ë¡œí¼í‹°ì— ë°ì´í„° ì •ì œë¥¼ ì§€ì •í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.</li>
<li>ì¥ì <ol>
<li>ë°ì´í„°ì˜ ì›í˜•ì„ ì €ì¥í•´ë†“ê³  í•„ìš”ì— ë”°ë¼ ì •ì œí•˜ì—¬ ì“¸ ìˆ˜ ìˆë‹¤</li>
<li>ìœ„ 3ê°€ì§€ ì¤‘ ê°€ì¥ ì¢‹ì€ ë°©ì‹ìœ¼ë¡œ ê³ ë ¤ëœë‹¤.</li>
</ol>
</li>
</ol>
</li>
</ol>
<h1># 3. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ ë Œë”ë§ ìµœì í™”</h1>
<blockquote>
<p>isFetching ì „í™˜</p>
</blockquote>
<p>useQueryë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ê²½ìš° isFetching ìƒíƒœê°€ true â†’ falseë¡œ ë³€í™˜ë˜ëŠ” ê³¼ì •ì—ì„œ 2ë²ˆì˜ ë Œë”ë§ì„ ê±°ì¹˜ê²Œ ëœë‹¤.</p>
<blockquote>
<p>notifyOnChangeProps: â€˜dataâ€™</p>
</blockquote>
<p>ì´ëŸ¬í•œ ë‚­ë¹„ë¥¼ ì¤„ì´ê¸° ìœ„í•´ select option ê°ì²´ì— notifyOnChangeProps í”„ë¡œí¼í‹°ì— â€˜dataâ€™ë¥¼ ê°’ìœ¼ë¡œ ì£¼ì–´ ì‹¤ì œì ìœ¼ë¡œ ë°ì´í„°ê°€ ë³€í™˜ë˜ì—ˆì„ ê²½ìš°ì—ë§Œ ë Œë”ë§ì´ ì¼ì–´ë‚˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.</p>
<blockquote>
<p>ë™ê¸°í™”ìœ ì§€</p>
</blockquote>
<p>ê·¸ëŸ¬ë‚˜ ìœ„ì™€ê°™ì´ dataê°’ë§Œì„ íŠ¸ë¦¬ê±°ë¡œ ë°ì´í„°ì˜ í‘œì¶œì„ í•˜ê²Œ ë  ê²½ìš° í•´ë‹¹ fetchingì´ errorì¼ ê²½ìš°ì— ëŒ€í•œ í‘œì¶œ ì—¬ë¶€ë¥¼ íŠ¸ë¦¬ê±° í•  ìˆ˜ ì—†ë‹¤.</p>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-comment">// ğŸš¨ will track all fields</span>
<span class="hljs-keyword">const</span> { isLoading, ...queryInfo } = <span class="hljs-title function_">useQuery</span>(...)

<span class="hljs-comment">// âœ… this is totally fine</span>
<span class="hljs-keyword">const</span> { isLoading</code>
      </pre>
    </div>
  
    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>

<span class="hljs-keyword">const</span> queryInfo = <span class="hljs-title function_">useQuery</span>(...)

<span class="hljs-comment">// ğŸš¨ will not corectly track data</span>
<span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(queryInfo.<span class="hljs-property">data</span>)
})

<span class="hljs-comment">// âœ… fine because the dependency array is accessed during render</span>
<span class="hljs-title class_">React</span>.<span class="hljs-title function_">useEffect</span>(<span class="hljs-function">() =&gt;</span> {
    <span class="hljs-variable language_">console</span>.<span class="hljs-title function_">log</span>(queryInfo.<span class="hljs-property">data</span>)
}, [queryInfo.<span class="hljs-property">data</span>])</code>
      </pre>
    </div>
  <blockquote>
<p>êµ¬ì¡° ê³µìœ </p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
[
  { <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Learn React&#x27;</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;active&#x27;</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Learn React Query&#x27;</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;todo&#x27;</span> },
];</code>
      </pre>
    </div>
  
    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
[
  -{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Learn React&#x27;</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;active&#x27;</span> },
  +{ <span class="hljs-attr">id</span>: <span class="hljs-number">1</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Learn React&#x27;</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;done&#x27;</span> },
  { <span class="hljs-attr">id</span>: <span class="hljs-number">2</span>, <span class="hljs-attr">name</span>: <span class="hljs-string">&#x27;Learn React Query&#x27;</span>, <span class="hljs-attr">status</span>: <span class="hljs-string">&#x27;todo&#x27;</span> },
];</code>
      </pre>
    </div>
  <p>ìœ„ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ todo ë¦¬ìŠ¤íŠ¸ê°€ ìˆì—ˆê³ , ê·¸ ì¤‘ì—ì„œ idê°€ 1ì¸ todoì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ì—ˆì„ ê²½ìš° react-queryëŠ” ë‚˜ë¨¸ì§€ ë°ì´í„° ( id = 2 )ì˜ ë°ì´í„°ëŠ” ì´ì „ì˜ ì°¸ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•œë‹¤. ë”°ë¼ì„œ idê°€ 2ì¸ todoë¥¼ ì°¸ì¡°í•˜ëŠ” ( ex : select optionì„ ì´ìš©) componentëŠ” idê°€ 1ì¸ todoì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ì—ˆì–´ì„œ re-renderingë˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<p>í•˜ì§€ë§Œ í•´ë‹¹ query-keyì— ì €ì¥ëœ ë°ì´í„°ê°€ ì•„ì£¼ í´ ê²½ìš° JSON ì§ë ¬í™”ë¥¼ í†µí•´ queryFnìœ¼ë¡œ ë³€í˜•ëœ ë°ì´í„°ê°€ ì´ì „ì˜ ë°ì´í„°ì™€ ë³€ê²½ì‚¬í•­ì´ ìˆëŠ”ì§€ íŒŒì•…í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë³‘ëª©í˜„ìƒì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.</p>
<p>ë”°ë¼ì„œ ì´ëŸ¬í•œ ìµœì í™”ê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤ë©´ ( ë°›ì•„ì˜¨ ë°ì´í„°ê°€ ì‹¤ì œë¡œ ë³€ê²½ëœ ë¶€ë¶„ë§Œ êµì²´í•˜ë„ë¡ í•˜ì—¬ ë³€ê²½ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ê³  ìˆëŠ” componentë“¤ì˜ re-renderingì„ ë°©ì§€í•˜ëŠ” ìµœì í™” ) structureSharing: falseë¥¼ í†µí•´ ëŒ ìˆ˜ ìˆë‹¤.</p>
<h1>#4. React-query ìƒíƒœ í™•ì¸</h1>
<p>ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” ì¿¼ë¦¬ì˜ ìƒíƒœ í•„ë“œì— ì‰½ê²Œ access í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. ë”°ë¼ì„œ í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ queryê°€ ì–´ë–¤ ìƒíƒœì¸ì§€( ë¡œë”©, ì—ëŸ¬, íŒ¨ì¹­ ë“± ) ì‰½ê²Œ íŒŒì•…ì´ ëœë‹¤. react-queryì—ì„œ ë…¸ì¶œí•´ì£¼ëŠ” í”Œë˜ê·¸ê°’ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<ul>
<li>success: ì¿¼ë¦¬ê°€ ì„±ê³µí–ˆìœ¼ë©°, ë°ì´í„°ê°€ ìˆìŒ.</li>
<li>error: ì¿¼ë¦¬ê°€ ì‹¤íŒ¨ í–ˆìœ¼ë©°, ì˜¤ë¥˜ê°€ ì„¤ì •ë˜ì—ˆìŒ.</li>
<li>loading: ì¿¼ë¦¬ë¥¼ ì²˜ìŒìœ¼ë¡œ ë¡œë“œì¤‘ì´ë©°, í˜„ì¬ ë°ì´í„°ê°€ ì—†ìŒ.</li>
<li>idle: ì¿¼ë¦¬ ë¹„í™œì„± ìƒíƒœ ( ë¡œë“œ ëœ ì  ì—†ìŒ )</li>
</ul>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">const</span> todos = <span class="hljs-title function_">useTodos</span>();

<span class="hljs-keyword">if</span> (todos.<span class="hljs-property">isLoading</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;Loading...&#x27;</span>;
}
<span class="hljs-keyword">if</span> (todos.<span class="hljs-property">error</span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;An error has occurred: &#x27;</span> + todos.<span class="hljs-property">error</span>.<span class="hljs-property">message</span>;
}

<span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>{todos.data.map(renderTodo)}<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span></span>;</code>
      </pre>
    </div>
  <p>ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„  re-fetching ë©”ì»¤ë‹ˆì¦˜ì´ ì—†ì§€ë§Œ, ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„  refetchOnMount, refetchOnWindowFocus, refetchOnReconnetì˜ ê°œë…ì„ ì œê³µí•˜ì—¬ ë°ì´í„° refetchë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡í•´ì¤ë‹ˆë‹¤. ( ê·¸ëŸ¬ë‚˜ ë°±ê·¸ë¼ìš´ë“œ refetchì˜ ì‹¤íŒ¨ì‹œ í˜¼ë€ìŠ¤ëŸ¬ìš´ uxê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆë‹¤. )</p>
<blockquote>
<p>ë°±ê·¸ë¼ìš´ë“œ ì˜¤ë¥˜</p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
{
  <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;error&quot;</span>,
  <span class="hljs-string">&quot;error&quot;</span>: { <span class="hljs-string">&quot;message&quot;</span>: <span class="hljs-string">&quot;Something went wrong&quot;</span> },
  <span class="hljs-string">&quot;data&quot;</span>: [{ ... }]
}</code>
      </pre>
    </div>
  <p>fetchê°€ ì‹¤íŒ¨í•œ ì¿¼ë¦¬ì˜ ë°ì´í„° ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ì„ ìˆ˜ ìˆë‹¤. ìœ„ì™€ê°™ì´ fetchê°€ ì‹¤íŒ¨í•˜ì˜€ìŒì—ë„, ì´ì „ì— ê°€ì§€ê³  ìˆë˜ dataëŠ” ì‚­ì œë˜ì§€ ì•Šê³  ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìœ¼ë©°, stale-while-revalidate ìºì‹± ë©”ì»¤ë‹ˆì¦˜ì„ ìˆ˜ìš©í•œ ê²°ê³¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. (re-fetchì‘ì—…ì€ defaultë¡œ 3ë²ˆê¹Œì§€ ì‹¤í–‰ëœë‹¤.)</p>
<h1>#5. React-query í…ŒìŠ¤íŠ¸í•˜ê¸°</h1>
<h1>#6. React-Query &amp; TypeScript</h1>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">export</span> <span class="hljs-keyword">function</span> useQuery&lt;
  <span class="hljs-title class_">TQueryFnData</span> = unknown,
  <span class="hljs-title class_">TError</span> = unknown,
  <span class="hljs-title class_">TData</span> = <span class="hljs-title class_">TQueryFnData</span>,
  <span class="hljs-title class_">TQueryKey</span> <span class="hljs-keyword">extends</span> <span class="hljs-title class_">QueryKey</span> = <span class="hljs-title class_">QueryKey</span>
&gt;</code>
      </pre>
    </div>
  <blockquote>
<p>ë„¤ê°€ì§€ generic</p>
</blockquote>
<ul>
<li>TQueryFnData: queryFnì—ì„œ ë°˜í™˜ëœ ìœ í˜•.</li>
<li>TError: queryFnì—ì„œ ì˜ˆìƒë˜ëŠ” ì˜¤ë¥˜ ìœ í˜•</li>
<li>TData: ë°ì´í„° ì†ì„±. (queryFnì—ì„œ ë°˜í™˜í•˜ëŠ” ë°ì´í„° ìœ í˜•ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)</li>
<li>TQueryKey: queryFnì— ì „ë‹¬ëœ queryKeyë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ë§Œ ì‚¬ìš©í•˜ëŠ” ìœ í˜•</li>
</ul>
<blockquote>
<p>íƒ€ì… ì¶”ë¡ </p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> identity&lt;T&gt;(<span class="hljs-attr">value</span>: T): T {
  <span class="hljs-keyword">return</span> value;
}

<span class="hljs-comment">// ğŸš¨ no need to provide the generic</span>
<span class="hljs-keyword">let</span> result = identity &lt; number &gt; <span class="hljs-number">23</span>;

<span class="hljs-comment">// âš ï¸ or to annotate the result</span>
<span class="hljs-keyword">let</span> <span class="hljs-attr">result</span>: number = <span class="hljs-title function_">identity</span>(<span class="hljs-number">23</span>);

<span class="hljs-comment">// ğŸ˜ infers correctly to <code>string</code></span>
<span class="hljs-keyword">let</span> result = <span class="hljs-title function_">identity</span>(<span class="hljs-string">&#x27;react-query&#x27;</span>);</code>
      </pre>
    </div>
  <blockquote>
</blockquote>
<blockquote>
<p>ë¶€ë¶„ íƒ€ì… ì¸ìˆ˜ ì¶”ë¡ </p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useGroupCount</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> useQuery&lt;<span class="hljs-title class_">Group</span>[], <span class="hljs-title class_">Error</span>&gt;(<span class="hljs-string">&#x27;groups&#x27;</span>, fetchGroups, {
    <span class="hljs-attr">select</span>: <span class="hljs-function">(<span class="hljs-params">groups</span>) =&gt;</span> groups.<span class="hljs-property">length</span>,
    <span class="hljs-comment">// ğŸš¨ Type &#x27;(groups: Group[]) =&gt; number&#x27; is not assignable to type &#x27;(data: Group[]) =&gt; Group[]&#x27;.</span>
    <span class="hljs-comment">// Type &#x27;number&#x27; is not assignable to type &#x27;Group[]&#x27;.ts(2322)</span>
  })
}</code>
      </pre>
    </div>
  
    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useGroupCount</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// âœ… fixed it</span>
  <span class="hljs-keyword">return</span> useQuery&lt;<span class="hljs-title class_">Group</span>[], <span class="hljs-title class_">Error</span>, number&gt;(<span class="hljs-string">&#x27;groups&#x27;</span>, fetchGroups, {
    <span class="hljs-attr">select</span>: <span class="hljs-function">(<span class="hljs-params">groups</span>) =&gt;</span> groups.<span class="hljs-property">length</span>,
  })
}</code>
      </pre>
    </div>
  <p>ìœ„ì˜ ê²½ìš° useQueryì—ì„œ selectì— ëŒ€í•œ typeì„ ì§€ì •í•´ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ì—†ë‹¤.</p>
<p>ì•„ë˜ì˜ ê²½ìš° numberë¡œ selectë¶€ì˜ íƒ€ì…ì„ ì„ ì–¸í•´ì£¼ì—ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ íƒ€ì…ìœ¼ë¡œ ì´ìš©ì´ ëœë‹¤.</p>
<blockquote>
<p>ëª¨ë“ ê²ƒì„ ì¶”ë¡ </p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useGroups</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// ğŸš¨ data will be <code>any</code> here</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useQuery</span>(<span class="hljs-string">&#x27;groups&#x27;</span>, <span class="hljs-function">() =&gt;</span>
    axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;groups&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.<span class="hljs-property">data</span>)
  );
}</code>
      </pre>
    </div>
  <p>ë§Œì•½ ìœ„ì™€ê°™ì´ axiosì˜ ë°˜í™˜ê°’ì„ ê·¸ëŒ€ë¡œ useQueryì—ì„œ ì´ìš©í•˜ê²Œ ëœë‹¤ë©´, íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ì—†ê³  fetch libraryì—ì„œ ì œê³µí•˜ëŠ” íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ì¸ìš©í•˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ íƒ€ì…ì„ ìœ ì¶”í•  ìˆ˜ ìˆë„ë¡ ì¤‘ê°„ layer functionì„ ì‘ì„±í•˜ì—¬ ì´ìš©í•˜ëŠ” ë°©ë²•ì„ ì“°ëŠ”ê²Œ ì¢‹ë‹¤.</p>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">fetchGroups</span>(<span class="hljs-params"></span>): <span class="hljs-title class_">Promise</span>&lt;<span class="hljs-title class_">Group</span>[]&gt; {
  <span class="hljs-keyword">return</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string">&#x27;groups&#x27;</span>).<span class="hljs-title function_">then</span>(<span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> response.<span class="hljs-property">data</span>);
}

<span class="hljs-comment">// âœ… data will be <code>Group[] | undefined</code> here</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useGroups</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useQuery</span>(<span class="hljs-string">&#x27;groups&#x27;</span>, fetchGroups);
}

<span class="hljs-comment">// âœ… data will be <code>number | undefined</code> here</span>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">useGroupCount</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useQuery</span>(<span class="hljs-string">&#x27;groups&#x27;</span>, fetchGroups, {
    <span class="hljs-attr">select</span>: <span class="hljs-function">(<span class="hljs-params">groups</span>) =&gt;</span> groups.<span class="hljs-property">length</span>,
  });
}</code>
      </pre>
    </div>
  <blockquote>
<p>íƒ€ì… ì¶•ì†Œ</p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">const</span> { data, isSuccess } = <span class="hljs-title function_">useGroups</span>();
<span class="hljs-keyword">if</span> (isSuccess) {
  <span class="hljs-comment">// ğŸš¨ data will still be <code>Group[] | undefined</code> here</span>
}

<span class="hljs-keyword">const</span> groupsQuery = <span class="hljs-title function_">useGroups</span>();
<span class="hljs-keyword">if</span> (groupsQuery.<span class="hljs-property">isSuccess</span>) {
  <span class="hljs-comment">// âœ… groupsQuery.data will now be <code>Group[]</code></span>
}</code>
      </pre>
    </div>
  <p>ìœ„ì˜ ë°©ì‹ì²˜ëŸ¼ destructuringì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ typeì¶”ë¡ ì—ì„œ undefinedê°€ ì¶”ê°€ë  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ êµ¬ì¡°ë¶„í•´í• ë‹¹ë³´ë‹¨ ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™€ì„œ chaningì„ ì´ìš©í•˜ì—¬ ì´ìš©í•˜ëŠ”ê²ƒì´ íƒ€ì…ì˜ ë²”ìœ„ë¥¼ ì¶•ì†Œí•  ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì´ë‹¤.</p>
<h1>#8. íš¨ê³¼ì ì¸ React-Query key</h1>
<p>ë¦¬ì•¡íŠ¸ì¿¼ë¦¬ì—ì„œ í‚¤ëŠ” ì¤‘ìš” í•µì‹¬ê°œë…ìœ¼ë¡œ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ë¶€ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìºì‹œí•˜ê³ , re-fetchë¥¼ í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ê°œë…ì´ë‹¤.</p>
<blockquote>
<p>ë°ì´í„° ìºì‹±</p>
</blockquote>
<p>ì¿¼ë¦¬ ìºì‹œëŠ” ì§ë ¬í™”ëœ ì¿¼ë¦¬í‚¤ë¥¼ í‚¤ë¡œ í•˜ê³ , ë°ì´í„°ì™€ ë§¤í„°ì •ë³´ë¥¼ ê°–ëŠ” javascript objectë¥¼ valueë¡œ ê°–ë„ë¡ í•œë‹¤.</p>
<p>ì´ë•Œ, query keyëŠ” ê³ ìœ í•´ì•¼ í•˜ê³ , useQuery â†”Â useInfiniteQueryì— ë™ì¼í•œ ì¿¼ë¦¬í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.</p>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-title function_">useQuery</span>([<span class="hljs-string">&#x27;todos&#x27;</span>], fetchTodos);

<span class="hljs-comment">// ğŸš¨ this won&#x27;t work</span>
<span class="hljs-title function_">useInfiniteQuery</span>([<span class="hljs-string">&#x27;todos&#x27;</span>], fetchInfiniteTodos);

<span class="hljs-comment">// âœ… choose something else instead</span>
<span class="hljs-title function_">useInfiniteQuery</span>([<span class="hljs-string">&#x27;infiniteTodos&#x27;</span>], fetchInfiniteTodos);</code>
      </pre>
    </div>
  <blockquote>
<p>ìë™ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸°</p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> { data, refetch } = <span class="hljs-title function_">useQuery</span>([<span class="hljs-string">&#x27;todos&#x27;</span>], fetchTodos)

  <span class="hljs-comment">// â“ how do I pass parameters to refetch â“</span>
  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Filters</span> <span class="hljs-attr">onApply</span>=<span class="hljs-string">{()</span> =&gt;</span> refetch(???)} /&gt;</span>
}</code>
      </pre>
    </div>
  <p>ìœ„ì˜ ì½”ë“œë¥¼ ë³´ë©´ finterì—ì„œ í•„í„°ê°€ selectë˜ì–´ applyë˜ëŠ” ì‹œì ì— todosë¥¼ í•´ë‹¹ í•„í„°ì— ë§ëŠ” ê²ƒë“¤ë§Œ í•„í„°ë§í•˜ì—¬ ê°€ì ¸ì˜¤ê¸¸ ì›í•œë‹¤.</p>
<p>ê·¸ëŸ¬ë‚˜ applyì— refetchë¥¼ í•˜ë„ë¡ í•˜ëŠ” ë°©ì‹ì€ ì ì ˆí•˜ì§€ ì•Šë‹¤. todosì— í•´ë‹¹í•˜ëŠ” cacheê°’ì€ ì´ì „ê³¼ ì–¸ì œë‚˜ ë™ì¼í•˜ê²Œ ìˆì„í…Œë‹ˆê¹. (query keyê°’ì€ ê·¸ëŒ€ë¡œì´ë¯€ë¡œ)</p>
<p>ë”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì•¼ í•œë‹¤.</p>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component</span>(<span class="hljs-params"></span>) {
  <span class="hljs-keyword">const</span> [filters, setFilters] = <span class="hljs-title class_">React</span>.<span class="hljs-title function_">useState</span>();
  <span class="hljs-keyword">const</span> { data } = <span class="hljs-title function_">useQuery</span>([<span class="hljs-string">&#x27;todos&#x27;</span>, filters], <span class="hljs-function">() =&gt;</span> <span class="hljs-title function_">fetchTodos</span>(filters));

  <span class="hljs-comment">// âœ… set local state and let it &quot;drive&quot; the query</span>
  <span class="hljs-keyword">return</span> <span class="language-xml"><span class="hljs-tag">&lt;<span class="hljs-name">Filters</span> <span class="hljs-attr">onApply</span>=<span class="hljs-string">{setFilters}</span> /&gt;</span></span>;
}</code>
      </pre>
    </div>
  <blockquote>
<p>ìˆ˜ë™ ìƒí˜¸ ì‘ìš©</p>
</blockquote>
<p>ì¿¼ë¦¬ìºì‹œì— ëŒ€í•œ ìˆ˜ë™ì ì¸ ìƒí˜¸ì‘ìš©ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„  invalidateQueries, setQueriesDataë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ, query filterë¥¼ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— filter ê°ì²´ì— ëª…ì‹œí•œ ì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ì¿¼ë¦¬ë“¤ì— ê´€í•˜ì—¬ ìƒí˜¸ì‘ìš©í•˜ë„ë¡ ì»¨íŠ¸ë¡¤ í•  ìˆ˜ ìˆë‹¤.</p>
<blockquote>
<p>íš¨ê³¼ì ì¸ ì¿¼ë¦¬ í‚¤</p>
</blockquote>
<ul>
<li>ë„ë©”ì¸ ë³„ë¡œ queries.tsë¡œ íŒŒì¼ ê´€ë¦¬í•˜ë„ë¡ í•œë‹¤.</li>
<li>ì¿¼ë¦¬í‚¤ëŠ” í•­ìƒ ë°°ì—´ë¡œ ë§Œë“ ë‹¤</li>
<li>ì¿¼ë¦¬í‚¤ ë°°ì—´ì€ ì¼ë°˜ì ì¸ê²ƒ â†’ êµ¬ì²´ì ì¸ê²ƒ ìˆœì„œë¡œ êµ¬ì²´í™”í•˜ì—¬ êµ¬ì¡°í™” í•œë‹¤.</li>
<li><h2>ì¿¼ë¦¬ í‚¤ íŒ©í† ë¦¬ ì‚¬ìš©</h2>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">const</span> todoKeys = {
  <span class="hljs-attr">all</span>: [<span class="hljs-string">&#x27;todos&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">lists</span>: <span class="hljs-function">() =&gt;</span> [...todoKeys.<span class="hljs-property">all</span>, <span class="hljs-string">&#x27;list&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">list</span>: <span class="hljs-function">(<span class="hljs-params">filters: string</span>) =&gt;</span> [...todoKeys.<span class="hljs-title function_">lists</span>(), { filters }] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">details</span>: <span class="hljs-function">() =&gt;</span> [...todoKeys.<span class="hljs-property">all</span>, <span class="hljs-string">&#x27;detail&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">detail</span>: <span class="hljs-function">(<span class="hljs-params">id: number</span>) =&gt;</span> [...todoKeys.<span class="hljs-title function_">details</span>(), id] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
}</code>
      </pre>
    </div>
  </li>
</ul>
<blockquote>
<p>QueryFunctionContext</p>
</blockquote>
<p>ìœ„ì˜ todoKeysë¥¼ ë³´ë©´ ì¿¼ë¦¬í‚¤ë¥¼ ë°°ì—´ë¡œ ì‘ì„±í–ˆë‹¤. ì´ë•Œ QueryFunctionContextë¥¼ ì´ìš©í•˜ë©´ ì…ë ¥ëœ queryKeyë¥¼ êµ¬ì¡°ë¶„í•´ í• ë‹¹ì‹œ</p>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">const</span> todoKeys = {
  <span class="hljs-attr">all</span>: [<span class="hljs-string">&#x27;todos&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">lists</span>: <span class="hljs-function">() =&gt;</span> [...todoKeys.<span class="hljs-property">all</span>, <span class="hljs-string">&#x27;list&#x27;</span>] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">list</span>: <span class="hljs-function">(<span class="hljs-params">state: State, sorting: Sorting</span>) =&gt;</span>
    [...todoKeys.<span class="hljs-title function_">lists</span>(), state, sorting] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchTodos</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">{
  queryKey,
}: <span class="hljs-comment">// ğŸ¤¯ only accept keys that come from the factory</span>
QueryFunctionContext&lt;ReturnType&lt;<span class="hljs-keyword">typeof</span> todoKeys[<span class="hljs-string">&#x27;list&#x27;</span>]&gt;&gt;</span>) =&gt; {
  <span class="hljs-keyword">const</span> [, , state, sorting] = queryKey
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string"><code>todos/&lt;span class=&quot;hljs-subst&quot;&gt;${state}&lt;/span&gt;?sorting=&lt;span class=&quot;hljs-subst&quot;&gt;${sorting}&lt;/span&gt;</code></span>)
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useTodos</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">const</span> { state, sorting } = <span class="hljs-title function_">useTodoParams</span>()

  <span class="hljs-comment">// âœ… build the key via the factory</span>
  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useQuery</span>(todoKeys.<span class="hljs-title function_">list</span>(state, sorting), fetchTodos)
}</code>
      </pre>
    </div>
  <p>ì½¤ë§ˆë¥¼ ì´ìš©í•˜ì—¬ ë¶ˆë¶„ëª…í•˜ê²Œ êµ¬ë¶„í•´ì•¼ë§Œ í•œë‹¤.</p>
<p>ë”°ë¼ì„œ ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì¿¼ë¦¬í‚¤ë¥¼ ê°ì²´ í˜•íƒœë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•ì´ ì¢‹ë‹¤.</p>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">const</span> todoKeys = {
  <span class="hljs-comment">// âœ… all keys are arrays with exactly one object</span>
  <span class="hljs-attr">all</span>: [{ <span class="hljs-attr">scope</span>: <span class="hljs-string">&#x27;todos&#x27;</span> }] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">lists</span>: <span class="hljs-function">() =&gt;</span> [{ ...todoKeys.<span class="hljs-property">all</span>[<span class="hljs-number">0</span>], <span class="hljs-attr">entity</span>: <span class="hljs-string">&#x27;list&#x27;</span> }] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
  <span class="hljs-attr">list</span>: <span class="hljs-function">(<span class="hljs-params">state: State, sorting: Sorting</span>) =&gt;</span>
    [{ ...todoKeys.<span class="hljs-title function_">lists</span>()[<span class="hljs-number">0</span>], state, sorting }] <span class="hljs-keyword">as</span> <span class="hljs-keyword">const</span>,
}

<span class="hljs-keyword">const</span> <span class="hljs-title function_">fetchTodos</span> = <span class="hljs-keyword">async</span> (<span class="hljs-params">{
  // âœ… extract named properties <span class="hljs-keyword">from</span> the queryKey
  queryKey: [{ state, sorting }],
}: QueryFunctionContext&lt;ReturnType&lt;<span class="hljs-keyword">typeof</span> todoKeys[<span class="hljs-string">&#x27;list&#x27;</span>]&gt;&gt;</span>) =&gt; {
  <span class="hljs-keyword">const</span> response = <span class="hljs-keyword">await</span> axios.<span class="hljs-title function_">get</span>(<span class="hljs-string"><code>todos/&lt;span class=&quot;hljs-subst&quot;&gt;${state}&lt;/span&gt;?sorting=&lt;span class=&quot;hljs-subst&quot;&gt;${sorting}&lt;/span&gt;</code></span>)
  <span class="hljs-keyword">return</span> response.<span class="hljs-property">data</span>
}

<span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> <span class="hljs-title function_">useTodos</span> = (<span class="hljs-params"></span>) =&gt; {
  <span class="hljs-keyword">const</span> { state, sorting } = <span class="hljs-title function_">useTodoParams</span>()

  <span class="hljs-keyword">return</span> <span class="hljs-title function_">useQuery</span>(todoKeys.<span class="hljs-title function_">list</span>(state, sorting), fetchTodos)
}</code>
      </pre>
    </div>
  <h1>#9. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ placeholder ë° init data</h1>
<p>ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„œ ë™ê¸°ì‹ìœ¼ë¡œ ë¯¸ë¦¬ ê°’ì„ ì±„ìš°ëŠ” ë°©ì‹ìœ¼ë¡œ ë‘ê°€ì§€ë¥¼ ì œê³µí•œë‹¤.</p>
<ul>
<li>placeholder</li>
<li>initial data</li>
</ul>
<blockquote>
<p>ìœ ì‚¬ì </p>
</blockquote>

    <div class="mockup-code" style="width:90%;margin:auto;margin-bottom:20px;">
      <pre  style="margin-bottom:0;padding:0;background-color:var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));color:white;">
      <code>
<span class="hljs-keyword">function</span> <span class="hljs-title function_">Component</span>(<span class="hljs-params"></span>) {
  <span class="hljs-comment">// âœ… status will be success even if we have not yet fetched data</span>
  <span class="hljs-keyword">const</span> { data, status } = <span class="hljs-title function_">useQuery</span>([<span class="hljs-string">&#x27;number&#x27;</span>], fetchNumber, {
    <span class="hljs-attr">placeholderData</span>: <span class="hljs-number">23</span>,
  });

  <span class="hljs-comment">// âœ… same goes for initialData</span>
  <span class="hljs-keyword">const</span> { data, status } = <span class="hljs-title function_">useQuery</span>([<span class="hljs-string">&#x27;number&#x27;</span>], fetchNumber, {
    <span class="hljs-attr">initialData</span>: <span class="hljs-function">() =&gt;</span> <span class="hljs-number">42</span>,
  });
}</code>
      </pre>
    </div>
  <p>ë‘ê°€ì§€ ëª¨ë‘ ìºì‹œì— í•´ë‹¹ ì¿¼ë¦¬í‚¤ë¡œ ê°’ì´ ì €ì¥ë˜ì–´ìˆë‹¤ë©´, ì•„ë¬´ëŸ° ì—­í• ì„ í•˜ì§€ ëª»í•œë‹¤.</p>
<blockquote>
<p>ì°¨ì´ì </p>
</blockquote>
<ul>
<li>initialData: cacheìˆ˜ì¤€ì—ì„œ ì‘ë™<ul>
<li>cacheì— ê°’ì´ ì €ì¥ëœë‹¤.</li>
<li>cacheí•­ëª©ì˜ ìƒì„± ìˆœê°„( ì²«ë²ˆì§¸ observerê°€ mountë˜ëŠ” ì‹œì  )ì— ê°’ì´ ì €ì¥ëœë‹¤.</li>
</ul>
</li>
<li>placeholder: observerìˆ˜ì¤€ì—ì„œ ì‘ë™<ul>
<li>cacheì— ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.</li>
<li>ë”°ë¼ì„œ componentë§ˆë‹¤ placeholderì— ëŒ€í•œ ê°’ì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤</li>
</ul>
</li>
</ul>
<blockquote>
<p>ì—ëŸ¬ ì²˜ë¦¬</p>
</blockquote>
<p>background re-fetchê°€ ì‹¤íŒ¨í–ˆì„ ì‹œ</p>
<ul>
<li>initialData<ul>
<li>ìºì‹œì—” ì´ë¯¸ initialDataê°€ ì¡´ë°°í•˜ë¯€ë¡œ ë‹¤ë¥¸ background ì˜¤ë¥˜ì™€ ê°™ì´ ì²˜ë¦¬í•˜ë©´ ëœë‹¤.</li>
</ul>
</li>
<li>placeholder<ul>
<li>cacheì— ë°ì´í„°ê°€ ì ì¬ë˜ë ¤ê³  í•˜ëŠ” ìˆœê°„ ì˜¤ë¥˜ì´ë¯€ë¡œ placeholderëŠ” ì‚¬ë¼ì§€ê³  cacheì—” undefinedê°€ ì €ì¥ëœë‹¤.</li>
</ul>
</li>
</ul>
<h1>10. ìƒíƒœê´€ë¦¬ìë¡œì„œ react query</h1>
<blockquote>
<p>ë¹„ë™ê¸° ìƒíƒœ ê´€ë¦¬ì</p>
</blockquote>
<p>QueryClientProvider í•˜ìœ„ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  componentì—ì„  queryClientë¥¼ í†µí•´ í‘œì¶œí•˜ëŠ” ëª¨ë“  ë°ì´í„°ëŠ” observerë¡œì„œ ê´€ì°°ì´ ê°€ëŠ¥í•˜ê²Œ ë˜ë©° í•´ë‹¹ ê°’ì˜ ë³€ê²½ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ renderingí•˜ê²Œ ë˜ë¯€ë¡œ, ë¹„ë™ê¸° ìƒíƒœë¡œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ì—¬ í‘œì¶œ ê°€ëŠ¥í•˜ë‹¤.</p>
<blockquote>
<p>ë°ì´í„° ë™ê¸°í™” ë„êµ¬</p>
</blockquote>
<p>ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ cacheë°ì´í„°ë¥¼ êµ¬ë…í•˜ëŠ” componentë“¤ì€ cacheì— ì €ì¥ëœ snapshotì„±ê²©ì˜ ë°ì´í„°ë¥¼ í‘œì‹œë§Œ í•˜ëŠ”ê²ƒì´ë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ë°ì´í„°ê°€ stale í•œì§€ freshí•œì§€ íŒë³„í•˜ì—¬ cacheì— ì €ì¥ëœ snapshot ë°ì´í„°ê°€ back-endì™€ ë™ê¸°í™”ë˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
<li>ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ì´ì „ì˜ ë°ì´í„° ë™ê¸°í™”<ul>
<li>ê°€ì ¸ì˜¨ í›„ globalë¡œ ì €ì¥í•˜ê³ , ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.</li>
</ul>
</li>
<li>mountì‹œë§ˆë‹¤ ê°€ì ¸ì˜¤ê³  component localì— í•œì •<ul>
<li>useEffect(()â‡’{}, []) ì„ í†µí•´ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ component localì—ì„œ ì´ìš©í•œë‹¤.</li>
</ul>
</li>
</ul>
<blockquote>
<p>ë°ì´í„° ì¬ê²€ì¦( ì„œë²„ì™€ ë™ê¸°í™” ) í•˜ëŠ”ë™ì•ˆ stale data í‘œì¶œ</p>
</blockquote>
<p>ë°ì´í„°ë¥¼ ì„œë²„ë¡œë¶€í„° ìƒˆë¡œ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì€ ì‹œê°„ì´ ê±¸ë¦¬ê³ , í™”ë©´ì—ì„  í•­ìƒ loading bar || spinnerê°€ í‘œì¶œë˜ì–´ì•¼ë§Œ í•œë‹¤. ì´ê²ƒì€ ì‚¬ìš©ì ê´€ì ì—ì„œ â€œëŠë¦¬ë‹¤&quot;ëŠ” ëŠë‚Œì„ ë°›ê²Œ í•˜ë¯€ë¡œ, fresh ë°ì´í„°ê°€ í‘œì¶œë˜ê¸° ì „ì— staleë°ì´í„°ê°€ ë¨¼ì € í‘œì¶œë˜ëŠ”ê²ƒì´ ë‚˜ì„ ìˆ˜ ìˆë‹¤.</p>
<blockquote>
<p>smart re-fetch</p>
</blockquote>
<ul>
<li>refetchOnMount<ul>
<li>mountì‹œë§ˆë‹¤ ì¬ê²€ì¦í•œë‹¤.</li>
</ul>
</li>
<li>refetchOnWindowFocus<ul>
<li>ë¸Œë¼ìš°ì €íƒ­ì— í¬ì»¤ìŠ¤ë¥¼ í•  ë•Œë§ˆë‹¤ re-fetchí•œë‹¤. ì´ê²Œ ë„ˆë¬´ ë§ë‹¤ê³  ëŠë‚„ ìˆ˜ ìˆìœ¼ë‚˜, ì‚¬ìš©ì ê´€ì ì—ì„œ ë‹¤ë¥¸íƒ­ì— í¬ì»¤ì‹±ì„ í–ˆë‹¤ í•´ë‹¹ íƒ­ìœ¼ë¡œ ëŒì•„ì™”ì„ë•Œ freshë°ì´í„°ë¥¼ í‘œì¶œí•´ì£¼ëŠ”ê²ƒì€ ì‚¬ìš©ìì—ê²Œ ìµœì‹ ì˜ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ëŠ” ì™„ë²½í•œ ë°©ë²•ì´ë‹¤.</li>
</ul>
</li>
<li>refetchOnReconnect<ul>
<li>ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì¢…ë£Œ í›„ freshê°’ì„ í‘œì¶œí•´ì£¼ëŠ”ê²ƒ ë˜í•œ í™”ë©´ì˜ ê°’ì´ ì •í™•í•œì§€ ì—¬ë¶€ë¥¼ ë‹¤ì‹œ í™•ì¸í•  ë•Œ ì¢‹ì€ ì§€í‘œê°€ ë  ìˆ˜ ìˆë‹¤.</li>
</ul>
</li>
</ul>
<p>ë§Œì•½ cacheë°ì´í„°ë¥¼ ë°”ë¼ë³´ëŠ” componentë¥¼ ë‹¤ë¥¸ componentì˜ í•˜ìœ„ componentë¡œ ë„£ì„ ê²½ìš° refetchOnMountë¥¼ ì¼œë†“ê²Œ ë˜ë©´ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ë§ˆë‹¤ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì˜ ë°ì´í„°ë¥¼ ê³„ì†í•´ì„œ re-fetchí•˜ê¸° ë•Œë¬¸ì— refetchOnMountë¥¼ ë„ëŠ”ê²Œ ì¢‹ì„ ìˆ˜ ìˆë‹¤.</p>
<blockquote>
<p>staleTime ì‚¬ìš©ì ì§€ì •</p>
</blockquote>
<p>ìµœì‹ ê°’ì„ í‘œì¶œí•˜ê¸° ìœ„í•œ ëª©ì ìœ¼ë¡œ ì¤‘ë³µìš”ì²­ì„ ì œê±°í•˜ê¸° ìœ„í•´ ìµœì†Œ 20ì´ˆ ì •ë„ë¡œ ì„¤ì •í•˜ëŠ”ê²Œ ì¢‹ì€ ì„ íƒì¼ ìˆ˜ ìˆë‹¤.</p>
<p>ì´ëŸ¬í•œ ì„¤ì •ë“¤ì„ ì¡ê¸°ìœ„í•´ setQueryDefaultsë¥¼ ì´ìš©í•´ queryKeyë“¤ì˜ ê¸°ë³¸ì„¤ì •ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</p>
</div></article><div class="flex justify-between"><button class="btn btn-neutral btn-sm md:btn-md gap-2 lg:gap-3 "><svg class="h-6 w-6 fill-current md:h-8 md:w-8" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M15.41,16.58L10.83,12L15.41,7.41L14,6L8,12L14,18L15.41,16.58Z"></path></svg><div class="flex flex-col items-start"><span class="text-base-content/50 hidden text-xs font-normal md:block">Prev</span><span>ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸</span></div></button><button class="btn btn-neutral btn-sm md:btn-md gap-2 lg:gap-3 "><div class="flex flex-col items-end"><span class="text-neutral-content/50 hidden text-xs font-normal md:block">Next</span><span>GraphQLì€ ë¬´ì—‡ì¸ê°€</span></div><svg class="h-6 w-6 fill-current md:h-8 md:w-8" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg></button></div></div><div class="drawer absolute left-5 z-30 w-0 bottom-[10vh]"><input id="my-drawer" type="checkbox" class="drawer-toggle"/><div class="drawer-content"><label class="btn btn-circle swap swap-rotate" for="my-drawer"><input type="checkbox"/><svg class="swap-off fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"></path></svg><svg class="swap-on fill-current" xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 512 512"><polygon points="400 145.49 366.51 112 256 222.51 145.49 112 112 145.49 222.51 256 112 366.51 145.49 400 256 289.49 366.51 400 400 366.51 289.49 256 400 145.49"></polygon></svg></label></div><div class="drawer-side"><label for="my-drawer" aria-label="close sidebar" class="drawer-overlay"></label><ul class="menu p-4 w-50 min-h-full bg-base-200 text-base-content"><li><a>Sun, ëˆ„êµ¬ëƒ ë„ˆ</a></li></ul></div></div></main><footer class="footer footer-center p-4 bg-base-100 text-base-content w-screen"><aside><p>Copyright Â© 2024 - sun</p></aside></footer></div></div><script id="__NEXT_DATA__" type="application/json" crossorigin="">{"props":{"pageProps":{"post":{"meta":{"title":"ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ tkdodo blog ê¸€ ë²ˆì—­","desc":"ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ê³µì‹ ì‚¬ì´íŠ¸ì— ìˆëŠ” ë¸”ë¡œê·¸ ê¸€ì„ ìŠ¤í„°ë””í•˜ì—¬ ê³µìœ ","date":"2024.01.28","tags":["react query","ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬"]},"content":"\nApollo Clientì˜ ë“±ì¥ìœ¼ë¡œ fetch library( ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ë¼ì´ë¸ŒëŸ¬ë¦¬ )ê°€ reduxì™€ ê°™ì€ ì „ì—­ ìƒíƒœê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ëŒ€ì²´í•  ìˆ˜ ìˆë‹¤ëŠ” ì˜ê²¬ì´ í™•ì‚°ë˜ì—ˆë‹¤.\n\n# # 1. ì‹¤ìš©ì  ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬\n\n\u003e í´ë¼ì´ì–¸íŠ¸ ìƒíƒœ VS ì„œë²„ ìƒíƒœ\n\nApolloëŠ” data fetching ë¿ë§Œ ì•„ë‹ˆë¼ ì„œë²„ì—ì„œ ë³´ë‚¸ ë°ì´í„°( fetchingí•´ì˜¨ ì„œë²„ ë°ì´í„° )ì— ëŒ€í•œ ìºì‹œ ê¸°ëŠ¥ê¹Œì§€ ì œê³µí•œë‹¤. ì¦‰ useQuery hookì„ ì‚¬ìš©í•˜ì—¬ fetchingí•œ í›„ ìºì‹±ëœ ë°ì´í„°ë¥¼ ì—¬ëŸ¬ Componentì—ì„œ ì´ìš©í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.\n\nì´ì „ì˜ í´ë¼ì´ì–¸íŠ¸ ì•±ë“¤ì€ ì„œë²„ì˜ ìƒíƒœ( í‘œì‹œí•˜ê³ ì í•˜ëŠ” ë°ì´í„° )ë¥¼ ì†Œìœ í•˜ì§€ ì•Šê³ , ê°€ì¥ ìµœì‹ ì˜ ìë£Œë¥¼ ê°€ì ¸ì™€ì„œ í‘œì¶œí•˜ëŠ”ë° ê·¸ì¹˜ê³  ìˆì—ˆë‹¤. í•­ìƒ ë°ì´í„°ì˜ ì†Œìœ ìëŠ” ì„œë²„ì˜€ë‹¤.\n\n\u003e React-Query\n\në¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” Fronet-endë‹¨ì—ì„œë„ data fetchingê³¼ loading, error stateë¥¼ í¬í•¨í•œ ìƒíƒœ ì „ì—­ì„ ë‹¨ìˆœí•˜ê²Œ ê´€ë¦¬í•˜ë„ë¡ í•˜ê³ ì í–ˆë‹¤. REST apiì²˜ëŸ¼\n\nreact-queryëŠ” refetchOnWindowFocusë¥¼ í†µí•´ ë‹¤ë¥¸ ì°½ì— ê°”ë˜ focusê°€ ë‹¤ì‹œ ëŒì•„ì˜¤ë©´ ì„œë²„ì— ë°ì´í„°ë¥¼ ìš”ì²­í•˜ì—¬ ìµœì‹ ìƒíƒœì˜ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤. ì´ë¥¼ í†µí•´ íŠ¸ë¦¬ê±°ëœ Componentì˜ í‘œì¶œëœ ë°ì´í„°ê°€ ë³€ê²½ë˜ë©° ì´ ëª¨ë“  ê³¼ì •ì€ loading spinnerê°€ ì—†ì´ ìë™ìœ¼ë¡œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.\n\n1. StaleTime: query dataê°€ ìµœì‹ (fresh) â†’ ì˜¤ë˜ëœ(stale)ìƒíƒœê°€ ë˜ëŠ”ë° ê¹Œì§€ ê±¸ë¦¬ëŠ” ì‹œê°„ì„ ëœ»í•©ë‹ˆë‹¤. ì¿¼ë¦¬ì˜ ë°ì´í„°ê°€ ìµœì‹ ì´ë¼ê³  íŒë‹¨ë  ê²½ìš° í•­ìƒ cacheì— ìˆëŠ” ë°ì´í„°ë§Œì„ í‘œì¶œí•˜ë„ë¡ í•©ë‹ˆë‹¤( ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ì—†ì´ )\n2. CacheTime: ë¹„í™œì„± ì¿¼ë¦¬ê°€ ìºì‹œì—ì„œ ì œê±° ë ë•Œê¹Œì§€ì˜ ì‹œê°„ì„ ëœ»í•©ë‹ˆë‹¤(default = 5min). í•´ë‹¹ ì¿¼ë¦¬ì— ë“±ë¡ëœ ê´€ì°°ì(observer)ê°€ ì—†ëŠ” ê²½ìš° ì¦‰ì‹œ ì¿¼ë¦¬ê°€ ë¹„í™œì„± ìƒíƒœê°€ ë©ë‹ˆë‹¤.\n\nâ‡’ ëŒ€ë¶€ë¶„ì˜ ê²½ìš° staleTimeì„ ì¡°ì •í•˜ë„ë¡í•˜ê³ , cacheTimeì€ ì¡°ì •í•  í•„ìš”ê°€ ê±°ì˜ ì—†ìŠµë‹ˆë‹¤.\n\n# # 2. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ ë°ì´í„° ë³€í™˜\n\n\u003e ë°ì´í„°ì˜ ë³€í™˜\n\nRESTë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ë•Œ, í™”ë©´ì— í‘œì¶œí•˜ê¸° ìœ„í•œ í˜•íƒœë¡œ ë°ì´í„°ë¥¼ ê°€ê³µí•  ìˆ˜ ìˆëŠ” ì§€ì ì€ 3 + 1êµ°ë°ê°€ ì¡´ì¬í•œë‹¤.\n\n1. back-end ( +1ì— í•´ë‹¹í•˜ë©° front-endì˜ ë‹´ë‹¹ì´ ì•„ë‹Œ êµ¬ì—­)\n   1. ë°±ì—”ë“œë‹¨ì—ì„œ ì• ì´ˆì— í•„ìš”í•œ ë°ì´í„° í˜•íƒœë¡œ ê°€ê³µí•˜ì—¬ ë°ì´í„°ë¥¼ ì „ë‹¬í•´ì£¼ëŠ” ë°©ë²•\n   2. ì¥ì \n      1. í‘œì¶œì— ì™„ì „íˆ ë¶€í•©í•˜ëŠ” í˜•íƒœ ê·¸ëŒ€ë¡œ ë°ì´í„°ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤.\n   3. ë‹¨ì \n      1. í”„ë¡ íŠ¸ì•¤ë“œì˜ ì˜ì—­ì´ ì•„ë‹ˆë‹¤\n2. queryFn\n   1. useQuery(${QUERY_KEY}, ${queryFn})\n      1. ì—¬ê¸°ì„œ queryFnì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ì—¬ cacheì— ì €ì¥í•  ìˆ˜ ìˆë‹¤.\n   2. ì¥ì \n      1. ë°ì´í„° ì²˜ë¦¬ ìœ„ì¹˜ê°€ ë°±ì—”ë“œì— ê°€ê¹ë‹¤ ( front-end component â†”Â cache â†”Â back-end )\n   3. ë‹¨ì \n      1. fetchingì„ í†µí•´ ë°›ì•„ì˜¨ ë°ì´í„°ë¥¼ queryFnì—ì„œ ê°€ê³µí•˜ì—¬ cacheì— ì €ì¥í•˜ë¯€ë¡œ ì›ë˜ fetchingí•´ì˜¨ ë°ì´í„° ì›í˜•ì„ ë‚˜ì¤‘ì— ë‹¤ì‹œ í™•ì¸í•  ìˆ˜ ì—†ë‹¤.\n3. Render\n   1. react component renderë‹¨ìœ„ì—ì„œ í•´ë‹¹ ë°ì´í„°ë¥¼ ê°€ê³µí•˜ëŠ” ë°©ë²•\n   2. ì¥ì \n      1. useMemoë¥¼ í†µí•´ ìµœì í™”ê°€ ê°€ëŠ¥í•˜ë‹¤.\n   3. ë‹¨ì \n      1. ë°ì´í„°ì˜ ì •í™•í•œ êµ¬ì¡°ë¥¼ devtoolsë¥¼ í†µí•´ í™•ì¸í•˜ê¸°ê°€ ì–´ë µë‹¤\n      2. êµ¬ë¬¸ì´ ë³µì¡í•˜ë‹¤\n4. ì„ íƒ ì˜µì…˜\n   1. useQuery( ${QUERY_KEY}, ${queryFn}, ${select_option} )ì—ì„œ select_option ê°ì²´ì—ì„œ selectí”„ë¡œí¼í‹°ì— ë°ì´í„° ì •ì œë¥¼ ì§€ì •í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.\n   2. ì¥ì \n      1. ë°ì´í„°ì˜ ì›í˜•ì„ ì €ì¥í•´ë†“ê³  í•„ìš”ì— ë”°ë¼ ì •ì œí•˜ì—¬ ì“¸ ìˆ˜ ìˆë‹¤\n      2. ìœ„ 3ê°€ì§€ ì¤‘ ê°€ì¥ ì¢‹ì€ ë°©ì‹ìœ¼ë¡œ ê³ ë ¤ëœë‹¤.\n\n# # 3. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ ë Œë”ë§ ìµœì í™”\n\n\u003e isFetching ì „í™˜\n\nuseQueryë¡œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ê²½ìš° isFetching ìƒíƒœê°€ true â†’ falseë¡œ ë³€í™˜ë˜ëŠ” ê³¼ì •ì—ì„œ 2ë²ˆì˜ ë Œë”ë§ì„ ê±°ì¹˜ê²Œ ëœë‹¤.\n\n\u003e notifyOnChangeProps: â€˜dataâ€™\n\nì´ëŸ¬í•œ ë‚­ë¹„ë¥¼ ì¤„ì´ê¸° ìœ„í•´ select option ê°ì²´ì— notifyOnChangeProps í”„ë¡œí¼í‹°ì— â€˜dataâ€™ë¥¼ ê°’ìœ¼ë¡œ ì£¼ì–´ ì‹¤ì œì ìœ¼ë¡œ ë°ì´í„°ê°€ ë³€í™˜ë˜ì—ˆì„ ê²½ìš°ì—ë§Œ ë Œë”ë§ì´ ì¼ì–´ë‚˜ë„ë¡ í•  ìˆ˜ ìˆë‹¤.\n\n\u003e ë™ê¸°í™”ìœ ì§€\n\nê·¸ëŸ¬ë‚˜ ìœ„ì™€ê°™ì´ dataê°’ë§Œì„ íŠ¸ë¦¬ê±°ë¡œ ë°ì´í„°ì˜ í‘œì¶œì„ í•˜ê²Œ ë  ê²½ìš° í•´ë‹¹ fetchingì´ errorì¼ ê²½ìš°ì— ëŒ€í•œ í‘œì¶œ ì—¬ë¶€ë¥¼ íŠ¸ë¦¬ê±° í•  ìˆ˜ ì—†ë‹¤.\n\n```jsx\n// ğŸš¨ will track all fields\nconst { isLoading, ...queryInfo } = useQuery(...)\n\n// âœ… this is totally fine\nconst { isLoading\n```\n\n```jsx\n\nconst queryInfo = useQuery(...)\n\n// ğŸš¨ will not corectly track data\nReact.useEffect(() =\u003e {\n    console.log(queryInfo.data)\n})\n\n// âœ… fine because the dependency array is accessed during render\nReact.useEffect(() =\u003e {\n    console.log(queryInfo.data)\n}, [queryInfo.data])\n```\n\n\u003e êµ¬ì¡° ê³µìœ \n\n```jsx\n[\n  { id: 1, name: 'Learn React', status: 'active' },\n  { id: 2, name: 'Learn React Query', status: 'todo' },\n];\n```\n\n```jsx\n[\n  -{ id: 1, name: 'Learn React', status: 'active' },\n  +{ id: 1, name: 'Learn React', status: 'done' },\n  { id: 2, name: 'Learn React Query', status: 'todo' },\n];\n```\n\nìœ„ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ todo ë¦¬ìŠ¤íŠ¸ê°€ ìˆì—ˆê³ , ê·¸ ì¤‘ì—ì„œ idê°€ 1ì¸ todoì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ì—ˆì„ ê²½ìš° react-queryëŠ” ë‚˜ë¨¸ì§€ ë°ì´í„° ( id = 2 )ì˜ ë°ì´í„°ëŠ” ì´ì „ì˜ ì°¸ì¡°ë¥¼ ê·¸ëŒ€ë¡œ ìœ ì§€í•œë‹¤. ë”°ë¼ì„œ idê°€ 2ì¸ todoë¥¼ ì°¸ì¡°í•˜ëŠ” ( ex : select optionì„ ì´ìš©) componentëŠ” idê°€ 1ì¸ todoì˜ ë°ì´í„°ê°€ ë³€ê²½ë˜ì—ˆì–´ì„œ re-renderingë˜ì§€ ì•ŠëŠ”ë‹¤.\n\ní•˜ì§€ë§Œ í•´ë‹¹ query-keyì— ì €ì¥ëœ ë°ì´í„°ê°€ ì•„ì£¼ í´ ê²½ìš° JSON ì§ë ¬í™”ë¥¼ í†µí•´ queryFnìœ¼ë¡œ ë³€í˜•ëœ ë°ì´í„°ê°€ ì´ì „ì˜ ë°ì´í„°ì™€ ë³€ê²½ì‚¬í•­ì´ ìˆëŠ”ì§€ íŒŒì•…í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì— ë³‘ëª©í˜„ìƒì´ ìƒê¸¸ ìˆ˜ ìˆë‹¤.\n\në”°ë¼ì„œ ì´ëŸ¬í•œ ìµœì í™”ê°€ í•„ìš”í•˜ì§€ ì•Šë‹¤ë©´ ( ë°›ì•„ì˜¨ ë°ì´í„°ê°€ ì‹¤ì œë¡œ ë³€ê²½ëœ ë¶€ë¶„ë§Œ êµì²´í•˜ë„ë¡ í•˜ì—¬ ë³€ê²½ë˜ì§€ ì•Šì€ ë°ì´í„°ë¥¼ ì°¸ì¡°í•˜ê³  ìˆëŠ” componentë“¤ì˜ re-renderingì„ ë°©ì§€í•˜ëŠ” ìµœì í™” ) structureSharing: falseë¥¼ í†µí•´ ëŒ ìˆ˜ ìˆë‹¤.\n\n# #4. React-query ìƒíƒœ í™•ì¸\n\në¦¬ì•¡íŠ¸ ì¿¼ë¦¬ëŠ” ì¿¼ë¦¬ì˜ ìƒíƒœ í•„ë“œì— ì‰½ê²Œ access í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤. ë”°ë¼ì„œ í˜„ì¬ ì‹¤í–‰ì¤‘ì¸ queryê°€ ì–´ë–¤ ìƒíƒœì¸ì§€( ë¡œë”©, ì—ëŸ¬, íŒ¨ì¹­ ë“± ) ì‰½ê²Œ íŒŒì•…ì´ ëœë‹¤. react-queryì—ì„œ ë…¸ì¶œí•´ì£¼ëŠ” í”Œë˜ê·¸ê°’ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n- success: ì¿¼ë¦¬ê°€ ì„±ê³µí–ˆìœ¼ë©°, ë°ì´í„°ê°€ ìˆìŒ.\n- error: ì¿¼ë¦¬ê°€ ì‹¤íŒ¨ í–ˆìœ¼ë©°, ì˜¤ë¥˜ê°€ ì„¤ì •ë˜ì—ˆìŒ.\n- loading: ì¿¼ë¦¬ë¥¼ ì²˜ìŒìœ¼ë¡œ ë¡œë“œì¤‘ì´ë©°, í˜„ì¬ ë°ì´í„°ê°€ ì—†ìŒ.\n- idle: ì¿¼ë¦¬ ë¹„í™œì„± ìƒíƒœ ( ë¡œë“œ ëœ ì  ì—†ìŒ )\n\n```jsx\nconst todos = useTodos();\n\nif (todos.isLoading) {\n  return 'Loading...';\n}\nif (todos.error) {\n  return 'An error has occurred: ' + todos.error.message;\n}\n\nreturn \u003cdiv\u003e{todos.data.map(renderTodo)}\u003c/div\u003e;\n```\n\në¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„  re-fetching ë©”ì»¤ë‹ˆì¦˜ì´ ì—†ì§€ë§Œ, ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„  refetchOnMount, refetchOnWindowFocus, refetchOnReconnetì˜ ê°œë…ì„ ì œê³µí•˜ì—¬ ë°ì´í„° refetchë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡í•´ì¤ë‹ˆë‹¤. ( ê·¸ëŸ¬ë‚˜ ë°±ê·¸ë¼ìš´ë“œ refetchì˜ ì‹¤íŒ¨ì‹œ í˜¼ë€ìŠ¤ëŸ¬ìš´ uxê°€ ë°œìƒí•  ê°€ëŠ¥ì„±ì´ ìˆë‹¤. )\n\n\u003e ë°±ê·¸ë¼ìš´ë“œ ì˜¤ë¥˜\n\n```jsx\n{\n  \"status\": \"error\",\n  \"error\": { \"message\": \"Something went wrong\" },\n  \"data\": [{ ... }]\n}\n```\n\nfetchê°€ ì‹¤íŒ¨í•œ ì¿¼ë¦¬ì˜ ë°ì´í„° ìƒíƒœëŠ” ë‹¤ìŒê³¼ ê°™ì„ ìˆ˜ ìˆë‹¤. ìœ„ì™€ê°™ì´ fetchê°€ ì‹¤íŒ¨í•˜ì˜€ìŒì—ë„, ì´ì „ì— ê°€ì§€ê³  ìˆë˜ dataëŠ” ì‚­ì œë˜ì§€ ì•Šê³  ê°€ì§€ê³  ìˆì„ ìˆ˜ ìˆìœ¼ë©°, stale-while-revalidate ìºì‹± ë©”ì»¤ë‹ˆì¦˜ì„ ìˆ˜ìš©í•œ ê²°ê³¼ë¡œ ë³¼ ìˆ˜ ìˆë‹¤. (re-fetchì‘ì—…ì€ defaultë¡œ 3ë²ˆê¹Œì§€ ì‹¤í–‰ëœë‹¤.)\n\n# #5. React-query í…ŒìŠ¤íŠ¸í•˜ê¸°\n\n# #6. React-Query \u0026 TypeScript\n\n```jsx\nexport function useQuery\u003c\n  TQueryFnData = unknown,\n  TError = unknown,\n  TData = TQueryFnData,\n  TQueryKey extends QueryKey = QueryKey\n\u003e\n```\n\n\u003e ë„¤ê°€ì§€ generic\n\n- TQueryFnData: queryFnì—ì„œ ë°˜í™˜ëœ ìœ í˜•.\n- TError: queryFnì—ì„œ ì˜ˆìƒë˜ëŠ” ì˜¤ë¥˜ ìœ í˜•\n- TData: ë°ì´í„° ì†ì„±. (queryFnì—ì„œ ë°˜í™˜í•˜ëŠ” ë°ì´í„° ìœ í˜•ê³¼ ë‹¤ë¥¼ ìˆ˜ ìˆìŒ)\n- TQueryKey: queryFnì— ì „ë‹¬ëœ queryKeyë¥¼ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ì—ë§Œ ì‚¬ìš©í•˜ëŠ” ìœ í˜•\n\n\u003e íƒ€ì… ì¶”ë¡ \n\n```jsx\nfunction identity\u003cT\u003e(value: T): T {\n  return value;\n}\n\n// ğŸš¨ no need to provide the generic\nlet result = identity \u003c number \u003e 23;\n\n// âš ï¸ or to annotate the result\nlet result: number = identity(23);\n\n// ğŸ˜ infers correctly to `string`\nlet result = identity('react-query');\n```\n\n\u003e\n\n\u003e ë¶€ë¶„ íƒ€ì… ì¸ìˆ˜ ì¶”ë¡ \n\n```jsx\nfunction useGroupCount() {\n  return useQuery\u003cGroup[], Error\u003e('groups', fetchGroups, {\n    select: (groups) =\u003e groups.length,\n    // ğŸš¨ Type '(groups: Group[]) =\u003e number' is not assignable to type '(data: Group[]) =\u003e Group[]'.\n    // Type 'number' is not assignable to type 'Group[]'.ts(2322)\n  })\n}\n```\n\n```jsx\nfunction useGroupCount() {\n  // âœ… fixed it\n  return useQuery\u003cGroup[], Error, number\u003e('groups', fetchGroups, {\n    select: (groups) =\u003e groups.length,\n  })\n}\n```\n\nìœ„ì˜ ê²½ìš° useQueryì—ì„œ selectì— ëŒ€í•œ typeì„ ì§€ì •í•´ì£¼ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì— íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ì—†ë‹¤.\n\nì•„ë˜ì˜ ê²½ìš° numberë¡œ selectë¶€ì˜ íƒ€ì…ì„ ì„ ì–¸í•´ì£¼ì—ˆê¸° ë•Œë¬¸ì— í•´ë‹¹ íƒ€ì…ìœ¼ë¡œ ì´ìš©ì´ ëœë‹¤.\n\n\u003e ëª¨ë“ ê²ƒì„ ì¶”ë¡ \n\n```jsx\nfunction useGroups() {\n  // ğŸš¨ data will be `any` here\n  return useQuery('groups', () =\u003e\n    axios.get('groups').then((response) =\u003e response.data)\n  );\n}\n```\n\në§Œì•½ ìœ„ì™€ê°™ì´ axiosì˜ ë°˜í™˜ê°’ì„ ê·¸ëŒ€ë¡œ useQueryì—ì„œ ì´ìš©í•˜ê²Œ ëœë‹¤ë©´, íƒ€ì…ì„ ì¶”ë¡ í•  ìˆ˜ ì—†ê³  fetch libraryì—ì„œ ì œê³µí•˜ëŠ” íƒ€ì…ì„ ê·¸ëŒ€ë¡œ ì¸ìš©í•˜ê²Œ ëœë‹¤. ë”°ë¼ì„œ íƒ€ì…ì„ ìœ ì¶”í•  ìˆ˜ ìˆë„ë¡ ì¤‘ê°„ layer functionì„ ì‘ì„±í•˜ì—¬ ì´ìš©í•˜ëŠ” ë°©ë²•ì„ ì“°ëŠ”ê²Œ ì¢‹ë‹¤.\n\n```jsx\nfunction fetchGroups(): Promise\u003cGroup[]\u003e {\n  return axios.get('groups').then((response) =\u003e response.data);\n}\n\n// âœ… data will be `Group[] | undefined` here\nfunction useGroups() {\n  return useQuery('groups', fetchGroups);\n}\n\n// âœ… data will be `number | undefined` here\nfunction useGroupCount() {\n  return useQuery('groups', fetchGroups, {\n    select: (groups) =\u003e groups.length,\n  });\n}\n```\n\n\u003e íƒ€ì… ì¶•ì†Œ\n\n```jsx\nconst { data, isSuccess } = useGroups();\nif (isSuccess) {\n  // ğŸš¨ data will still be `Group[] | undefined` here\n}\n\nconst groupsQuery = useGroups();\nif (groupsQuery.isSuccess) {\n  // âœ… groupsQuery.data will now be `Group[]`\n}\n```\n\nìœ„ì˜ ë°©ì‹ì²˜ëŸ¼ destructuringì„ ì‚¬ìš©í•˜ê²Œ ë˜ë©´ typeì¶”ë¡ ì—ì„œ undefinedê°€ ì¶”ê°€ë  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ êµ¬ì¡°ë¶„í•´í• ë‹¹ë³´ë‹¨ ê°ì²´ë¥¼ ê·¸ëŒ€ë¡œ ê°€ì ¸ì™€ì„œ chaningì„ ì´ìš©í•˜ì—¬ ì´ìš©í•˜ëŠ”ê²ƒì´ íƒ€ì…ì˜ ë²”ìœ„ë¥¼ ì¶•ì†Œí•  ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì´ë‹¤.\n\n# #8. íš¨ê³¼ì ì¸ React-Query key\n\në¦¬ì•¡íŠ¸ì¿¼ë¦¬ì—ì„œ í‚¤ëŠ” ì¤‘ìš” í•µì‹¬ê°œë…ìœ¼ë¡œ, ë¼ì´ë¸ŒëŸ¬ë¦¬ ë‚´ë¶€ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìºì‹œí•˜ê³ , re-fetchë¥¼ í•˜ê¸° ìœ„í•´ í•„ìš”í•œ ê°œë…ì´ë‹¤.\n\n\u003e ë°ì´í„° ìºì‹±\n\nì¿¼ë¦¬ ìºì‹œëŠ” ì§ë ¬í™”ëœ ì¿¼ë¦¬í‚¤ë¥¼ í‚¤ë¡œ í•˜ê³ , ë°ì´í„°ì™€ ë§¤í„°ì •ë³´ë¥¼ ê°–ëŠ” javascript objectë¥¼ valueë¡œ ê°–ë„ë¡ í•œë‹¤.\n\nì´ë•Œ, query keyëŠ” ê³ ìœ í•´ì•¼ í•˜ê³ , useQuery â†”Â useInfiniteQueryì— ë™ì¼í•œ ì¿¼ë¦¬í‚¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ë‹¤.\n\n```jsx\nuseQuery(['todos'], fetchTodos);\n\n// ğŸš¨ this won't work\nuseInfiniteQuery(['todos'], fetchInfiniteTodos);\n\n// âœ… choose something else instead\nuseInfiniteQuery(['infiniteTodos'], fetchInfiniteTodos);\n```\n\n\u003e ìë™ ë‹¤ì‹œ ê°€ì ¸ì˜¤ê¸°\n\n```jsx\nfunction Component() {\n  const { data, refetch } = useQuery(['todos'], fetchTodos)\n\n  // â“ how do I pass parameters to refetch â“\n  return \u003cFilters onApply={() =\u003e refetch(???)} /\u003e\n}\n```\n\nìœ„ì˜ ì½”ë“œë¥¼ ë³´ë©´ finterì—ì„œ í•„í„°ê°€ selectë˜ì–´ applyë˜ëŠ” ì‹œì ì— todosë¥¼ í•´ë‹¹ í•„í„°ì— ë§ëŠ” ê²ƒë“¤ë§Œ í•„í„°ë§í•˜ì—¬ ê°€ì ¸ì˜¤ê¸¸ ì›í•œë‹¤.\n\nê·¸ëŸ¬ë‚˜ applyì— refetchë¥¼ í•˜ë„ë¡ í•˜ëŠ” ë°©ì‹ì€ ì ì ˆí•˜ì§€ ì•Šë‹¤. todosì— í•´ë‹¹í•˜ëŠ” cacheê°’ì€ ì´ì „ê³¼ ì–¸ì œë‚˜ ë™ì¼í•˜ê²Œ ìˆì„í…Œë‹ˆê¹. (query keyê°’ì€ ê·¸ëŒ€ë¡œì´ë¯€ë¡œ)\n\në”°ë¼ì„œ ì•„ë˜ì™€ ê°™ì´ ë³€ê²½í•´ì•¼ í•œë‹¤.\n\n```jsx\nfunction Component() {\n  const [filters, setFilters] = React.useState();\n  const { data } = useQuery(['todos', filters], () =\u003e fetchTodos(filters));\n\n  // âœ… set local state and let it \"drive\" the query\n  return \u003cFilters onApply={setFilters} /\u003e;\n}\n```\n\n\u003e ìˆ˜ë™ ìƒí˜¸ ì‘ìš©\n\nì¿¼ë¦¬ìºì‹œì— ëŒ€í•œ ìˆ˜ë™ì ì¸ ìƒí˜¸ì‘ìš©ì„ ì´ìš©í•˜ê¸° ìœ„í•´ì„  invalidateQueries, setQueriesDataë¥¼ í™œìš©í•  ìˆ˜ ìˆë‹¤. ì´ë•Œ, query filterë¥¼ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— filter ê°ì²´ì— ëª…ì‹œí•œ ì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ì¿¼ë¦¬ë“¤ì— ê´€í•˜ì—¬ ìƒí˜¸ì‘ìš©í•˜ë„ë¡ ì»¨íŠ¸ë¡¤ í•  ìˆ˜ ìˆë‹¤.\n\n\u003e íš¨ê³¼ì ì¸ ì¿¼ë¦¬ í‚¤\n\n- ë„ë©”ì¸ ë³„ë¡œ queries.tsë¡œ íŒŒì¼ ê´€ë¦¬í•˜ë„ë¡ í•œë‹¤.\n- ì¿¼ë¦¬í‚¤ëŠ” í•­ìƒ ë°°ì—´ë¡œ ë§Œë“ ë‹¤\n- ì¿¼ë¦¬í‚¤ ë°°ì—´ì€ ì¼ë°˜ì ì¸ê²ƒ â†’ êµ¬ì²´ì ì¸ê²ƒ ìˆœì„œë¡œ êµ¬ì²´í™”í•˜ì—¬ êµ¬ì¡°í™” í•œë‹¤.\n- ## ì¿¼ë¦¬ í‚¤ íŒ©í† ë¦¬ ì‚¬ìš©\n  ```jsx\n  const todoKeys = {\n    all: ['todos'] as const,\n    lists: () =\u003e [...todoKeys.all, 'list'] as const,\n    list: (filters: string) =\u003e [...todoKeys.lists(), { filters }] as const,\n    details: () =\u003e [...todoKeys.all, 'detail'] as const,\n    detail: (id: number) =\u003e [...todoKeys.details(), id] as const,\n  }\n  ```\n\n\u003e QueryFunctionContext\n\nìœ„ì˜ todoKeysë¥¼ ë³´ë©´ ì¿¼ë¦¬í‚¤ë¥¼ ë°°ì—´ë¡œ ì‘ì„±í–ˆë‹¤. ì´ë•Œ QueryFunctionContextë¥¼ ì´ìš©í•˜ë©´ ì…ë ¥ëœ queryKeyë¥¼ êµ¬ì¡°ë¶„í•´ í• ë‹¹ì‹œ\n\n```jsx\nconst todoKeys = {\n  all: ['todos'] as const,\n  lists: () =\u003e [...todoKeys.all, 'list'] as const,\n  list: (state: State, sorting: Sorting) =\u003e\n    [...todoKeys.lists(), state, sorting] as const,\n}\n\nconst fetchTodos = async ({\n  queryKey,\n}: // ğŸ¤¯ only accept keys that come from the factory\nQueryFunctionContext\u003cReturnType\u003ctypeof todoKeys['list']\u003e\u003e) =\u003e {\n  const [, , state, sorting] = queryKey\n  const response = await axios.get(`todos/${state}?sorting=${sorting}`)\n  return response.data\n}\n\nexport const useTodos = () =\u003e {\n  const { state, sorting } = useTodoParams()\n\n  // âœ… build the key via the factory\n  return useQuery(todoKeys.list(state, sorting), fetchTodos)\n}\n```\n\nì½¤ë§ˆë¥¼ ì´ìš©í•˜ì—¬ ë¶ˆë¶„ëª…í•˜ê²Œ êµ¬ë¶„í•´ì•¼ë§Œ í•œë‹¤.\n\në”°ë¼ì„œ ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ì¿¼ë¦¬í‚¤ë¥¼ ê°ì²´ í˜•íƒœë¡œ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ë„ë¡ í•˜ëŠ” ë°©ë²•ì´ ì¢‹ë‹¤.\n\n```jsx\nconst todoKeys = {\n  // âœ… all keys are arrays with exactly one object\n  all: [{ scope: 'todos' }] as const,\n  lists: () =\u003e [{ ...todoKeys.all[0], entity: 'list' }] as const,\n  list: (state: State, sorting: Sorting) =\u003e\n    [{ ...todoKeys.lists()[0], state, sorting }] as const,\n}\n\nconst fetchTodos = async ({\n  // âœ… extract named properties from the queryKey\n  queryKey: [{ state, sorting }],\n}: QueryFunctionContext\u003cReturnType\u003ctypeof todoKeys['list']\u003e\u003e) =\u003e {\n  const response = await axios.get(`todos/${state}?sorting=${sorting}`)\n  return response.data\n}\n\nexport const useTodos = () =\u003e {\n  const { state, sorting } = useTodoParams()\n\n  return useQuery(todoKeys.list(state, sorting), fetchTodos)\n}\n```\n\n# #9. ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ placeholder ë° init data\n\në¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì—ì„œ ë™ê¸°ì‹ìœ¼ë¡œ ë¯¸ë¦¬ ê°’ì„ ì±„ìš°ëŠ” ë°©ì‹ìœ¼ë¡œ ë‘ê°€ì§€ë¥¼ ì œê³µí•œë‹¤.\n\n- placeholder\n- initial data\n\n\u003e ìœ ì‚¬ì \n\n```jsx\nfunction Component() {\n  // âœ… status will be success even if we have not yet fetched data\n  const { data, status } = useQuery(['number'], fetchNumber, {\n    placeholderData: 23,\n  });\n\n  // âœ… same goes for initialData\n  const { data, status } = useQuery(['number'], fetchNumber, {\n    initialData: () =\u003e 42,\n  });\n}\n```\n\në‘ê°€ì§€ ëª¨ë‘ ìºì‹œì— í•´ë‹¹ ì¿¼ë¦¬í‚¤ë¡œ ê°’ì´ ì €ì¥ë˜ì–´ìˆë‹¤ë©´, ì•„ë¬´ëŸ° ì—­í• ì„ í•˜ì§€ ëª»í•œë‹¤.\n\n\u003e ì°¨ì´ì \n\n- initialData: cacheìˆ˜ì¤€ì—ì„œ ì‘ë™\n  - cacheì— ê°’ì´ ì €ì¥ëœë‹¤.\n  - cacheí•­ëª©ì˜ ìƒì„± ìˆœê°„( ì²«ë²ˆì§¸ observerê°€ mountë˜ëŠ” ì‹œì  )ì— ê°’ì´ ì €ì¥ëœë‹¤.\n- placeholder: observerìˆ˜ì¤€ì—ì„œ ì‘ë™\n  - cacheì— ì €ì¥ë˜ì§€ ì•ŠëŠ”ë‹¤.\n  - ë”°ë¼ì„œ componentë§ˆë‹¤ placeholderì— ëŒ€í•œ ê°’ì´ ë‹¤ë¥¼ ìˆ˜ ìˆë‹¤\n\n\u003e ì—ëŸ¬ ì²˜ë¦¬\n\nbackground re-fetchê°€ ì‹¤íŒ¨í–ˆì„ ì‹œ\n\n- initialData\n  - ìºì‹œì—” ì´ë¯¸ initialDataê°€ ì¡´ë°°í•˜ë¯€ë¡œ ë‹¤ë¥¸ background ì˜¤ë¥˜ì™€ ê°™ì´ ì²˜ë¦¬í•˜ë©´ ëœë‹¤.\n- placeholder\n  - cacheì— ë°ì´í„°ê°€ ì ì¬ë˜ë ¤ê³  í•˜ëŠ” ìˆœê°„ ì˜¤ë¥˜ì´ë¯€ë¡œ placeholderëŠ” ì‚¬ë¼ì§€ê³  cacheì—” undefinedê°€ ì €ì¥ëœë‹¤.\n\n# 10. ìƒíƒœê´€ë¦¬ìë¡œì„œ react query\n\n\u003e ë¹„ë™ê¸° ìƒíƒœ ê´€ë¦¬ì\n\nQueryClientProvider í•˜ìœ„ì— ì¡´ì¬í•˜ëŠ” ëª¨ë“  componentì—ì„  queryClientë¥¼ í†µí•´ í‘œì¶œí•˜ëŠ” ëª¨ë“  ë°ì´í„°ëŠ” observerë¡œì„œ ê´€ì°°ì´ ê°€ëŠ¥í•˜ê²Œ ë˜ë©° í•´ë‹¹ ê°’ì˜ ë³€ê²½ì„ ìë™ìœ¼ë¡œ ê°ì§€í•˜ì—¬ renderingí•˜ê²Œ ë˜ë¯€ë¡œ, ë¹„ë™ê¸° ìƒíƒœë¡œ ë°ì´í„°ë¥¼ ê´€ë¦¬í•˜ì—¬ í‘œì¶œ ê°€ëŠ¥í•˜ë‹¤.\n\n\u003e ë°ì´í„° ë™ê¸°í™” ë„êµ¬\n\në¦¬ì•¡íŠ¸ ì¿¼ë¦¬ì˜ cacheë°ì´í„°ë¥¼ êµ¬ë…í•˜ëŠ” componentë“¤ì€ cacheì— ì €ì¥ëœ snapshotì„±ê²©ì˜ ë°ì´í„°ë¥¼ í‘œì‹œë§Œ í•˜ëŠ”ê²ƒì´ë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ë°ì´í„°ê°€ stale í•œì§€ freshí•œì§€ íŒë³„í•˜ì—¬ cacheì— ì €ì¥ëœ snapshot ë°ì´í„°ê°€ back-endì™€ ë™ê¸°í™”ë˜ë„ë¡ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.\n\n- ë¦¬ì•¡íŠ¸ ì¿¼ë¦¬ ì´ì „ì˜ ë°ì´í„° ë™ê¸°í™”\n  - ê°€ì ¸ì˜¨ í›„ globalë¡œ ì €ì¥í•˜ê³ , ì—…ë°ì´íŠ¸ í•˜ì§€ ì•ŠëŠ”ë‹¤.\n- mountì‹œë§ˆë‹¤ ê°€ì ¸ì˜¤ê³  component localì— í•œì •\n  - useEffect(()â‡’{}, []) ì„ í†µí•´ ê°€ì ¸ì˜¨ ë°ì´í„°ë¥¼ component localì—ì„œ ì´ìš©í•œë‹¤.\n\n\u003e ë°ì´í„° ì¬ê²€ì¦( ì„œë²„ì™€ ë™ê¸°í™” ) í•˜ëŠ”ë™ì•ˆ stale data í‘œì¶œ\n\në°ì´í„°ë¥¼ ì„œë²„ë¡œë¶€í„° ìƒˆë¡œ ê°€ì ¸ì˜¤ëŠ” ê³¼ì •ì€ ì‹œê°„ì´ ê±¸ë¦¬ê³ , í™”ë©´ì—ì„  í•­ìƒ loading bar || spinnerê°€ í‘œì¶œë˜ì–´ì•¼ë§Œ í•œë‹¤. ì´ê²ƒì€ ì‚¬ìš©ì ê´€ì ì—ì„œ â€œëŠë¦¬ë‹¤\"ëŠ” ëŠë‚Œì„ ë°›ê²Œ í•˜ë¯€ë¡œ, fresh ë°ì´í„°ê°€ í‘œì¶œë˜ê¸° ì „ì— staleë°ì´í„°ê°€ ë¨¼ì € í‘œì¶œë˜ëŠ”ê²ƒì´ ë‚˜ì„ ìˆ˜ ìˆë‹¤.\n\n\u003e smart re-fetch\n\n- refetchOnMount\n  - mountì‹œë§ˆë‹¤ ì¬ê²€ì¦í•œë‹¤.\n- refetchOnWindowFocus\n  - ë¸Œë¼ìš°ì €íƒ­ì— í¬ì»¤ìŠ¤ë¥¼ í•  ë•Œë§ˆë‹¤ re-fetchí•œë‹¤. ì´ê²Œ ë„ˆë¬´ ë§ë‹¤ê³  ëŠë‚„ ìˆ˜ ìˆìœ¼ë‚˜, ì‚¬ìš©ì ê´€ì ì—ì„œ ë‹¤ë¥¸íƒ­ì— í¬ì»¤ì‹±ì„ í–ˆë‹¤ í•´ë‹¹ íƒ­ìœ¼ë¡œ ëŒì•„ì™”ì„ë•Œ freshë°ì´í„°ë¥¼ í‘œì¶œí•´ì£¼ëŠ”ê²ƒì€ ì‚¬ìš©ìì—ê²Œ ìµœì‹ ì˜ ë°ì´í„°ë¥¼ í‘œì‹œí•˜ëŠ” ì™„ë²½í•œ ë°©ë²•ì´ë‹¤.\n- refetchOnReconnect\n  - ë„¤íŠ¸ì›Œí¬ ì—°ê²° ì¢…ë£Œ í›„ freshê°’ì„ í‘œì¶œí•´ì£¼ëŠ”ê²ƒ ë˜í•œ í™”ë©´ì˜ ê°’ì´ ì •í™•í•œì§€ ì—¬ë¶€ë¥¼ ë‹¤ì‹œ í™•ì¸í•  ë•Œ ì¢‹ì€ ì§€í‘œê°€ ë  ìˆ˜ ìˆë‹¤.\n\në§Œì•½ cacheë°ì´í„°ë¥¼ ë°”ë¼ë³´ëŠ” componentë¥¼ ë‹¤ë¥¸ componentì˜ í•˜ìœ„ componentë¡œ ë„£ì„ ê²½ìš° refetchOnMountë¥¼ ì¼œë†“ê²Œ ë˜ë©´ ìƒìœ„ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ë§ˆë‹¤ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì˜ ë°ì´í„°ë¥¼ ê³„ì†í•´ì„œ re-fetchí•˜ê¸° ë•Œë¬¸ì— refetchOnMountë¥¼ ë„ëŠ”ê²Œ ì¢‹ì„ ìˆ˜ ìˆë‹¤.\n\n\u003e staleTime ì‚¬ìš©ì ì§€ì •\n\nìµœì‹ ê°’ì„ í‘œì¶œí•˜ê¸° ìœ„í•œ ëª©ì ìœ¼ë¡œ ì¤‘ë³µìš”ì²­ì„ ì œê±°í•˜ê¸° ìœ„í•´ ìµœì†Œ 20ì´ˆ ì •ë„ë¡œ ì„¤ì •í•˜ëŠ”ê²Œ ì¢‹ì€ ì„ íƒì¼ ìˆ˜ ìˆë‹¤.\n\nì´ëŸ¬í•œ ì„¤ì •ë“¤ì„ ì¡ê¸°ìœ„í•´ setQueryDefaultsë¥¼ ì´ìš©í•´ queryKeyë“¤ì˜ ê¸°ë³¸ì„¤ì •ì„ ì§€ì •í•  ìˆ˜ ìˆë‹¤.\n","fileName":"2024-01-28","route":"2024-01-28"},"prev":{"meta":{"title":"ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸","desc":"ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì†ŒìŠ¤ì½”ë“œ í‰ê°€ ë° ì‹¤í–‰ì— ëŒ€í•œ ì„¤ëª…","date":"2024.01.27","tags":["ìë°”ìŠ¤í¬ë¦½íŠ¸","javascript","context","ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸"]},"content":"# ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸\n\n\u003e ìë°”ìŠ¤í¬ë¦½íŠ¸ ì†ŒìŠ¤ì½”ë“œì˜ 4ê°€ì§€ íƒ€ì…\n\u003e \n1. ì†ŒìŠ¤ ì½”ë“œ : ì „ì—­ì— ì¡´ì¬í•˜ëŠ” ì†ŒìŠ¤ì½”ë“œ( í•¨ìˆ˜, í´ë˜ìŠ¤ë™ì˜ ë‚´ë¶€ ì½”ë“œëŠ” í¬í•¨ë˜ì§€ ì•ŠìŒ )\n2. í•¨ìˆ˜ ì½”ë“œ : í•¨ìˆ˜ ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” ì†ŒìŠ¤ì½”ë“œ ( ì¤‘ì²© í•¨ìˆ˜, í´ë˜ìŠ¤ ë“±ì˜ ì½”ë“œëŠ” í¬í•¨ë˜ì§€ ì•ŠìŒ )\n3. eval ì½”ë“œ : evalì— ì „ë‹¬ë˜ì–´ ì‹¤í–‰ë˜ëŠ” ì†ŒìŠ¤ì½”ë“œ\n4. ëª¨ë“ˆ ì½”ë“œ : ëª¨ë“ˆ ë‚´ë¶€ì— ì¡´ì¬í•˜ëŠ” ì†ŒìŠ¤ì½”ë“œ ( ëª¨ë“ˆ ë‚´ë¶€ì˜ í•¨ìˆ˜, í´ë˜ìŠ¤ ë“±ì˜ ë‚´ë¶€ ì½”ë“œëŠ” í¬í•¨ë˜ì§€ ì•ŠìŒ )\n\n\u003e ì†ŒìŠ¤ ì½”ë“œ\n\u003e \n\nì „ì—­ ë³€ìˆ˜ë¥¼ ê´€ë¦¬í•˜ê¸° ìœ„í•œ ì „ì—­ ìŠ¤ì½”í”„ë¥¼ ìƒì„±í•˜ê³ , ì „ì—­ë³€ìˆ˜/í•¨ìˆ˜ ì„ ì–¸ë¬¸ ë“±ì„ ì „ì—­ ê°ì²´ì˜ í”„ë¡œí¼í‹°ì™€ ë©”ì„œë“œë¡œ ë°”ì¸ë”© ì‹œí‚¨ë‹¤.\n\n\u003e í•¨ìˆ˜ ì½”ë“œ\n\u003e \n\nì§€ì—­ ã……ì½”í”„ë¥¼ ìƒì„±í•˜ê³ , ì§€ì—­ë³€ìˆ˜, ë§¤ê°œë³€ìˆ˜, argumentsê°ì²´ë¥¼ ê´€ë¦¬í•œë‹¤.\n\n\u003e eval ì½”ë“œ\n\u003e \n\nstrict modeì—ì„œ ìì‹ ë§Œì˜ ìŠ¤ì½”í”„ë¥¼ ìƒì„±í•˜ê³  ì´ë¥¼í†µí•´ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ëœë‹¤.\n\n\u003e ëª¨ë“ˆ ì½”ë“œ\n\u003e \n\nëª¨ë“ˆë³„ ë…ë¦½ì  ëª¨ë“ˆ ìŠ¤ì½”í”„ë¥¼ ìƒì„±í•œë‹¤.\n\nëª¨ë“ˆ ì½”ë“œê°€ í‰ê°€ë˜ë©´ ëª¨ë“ˆì˜ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ìƒì„±ëœë‹¤.\n\n# ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì†ŒìŠ¤ì½”ë“œ í‰ê°€ ë° ì‹¤í–‰\n\nìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ì‹¤í–‰ì€ í¬ê²Œ ë‘ ê°€ì§€ ê³¼ì •ì´ ìˆë‹¤.\n\n1. ì†ŒìŠ¤ì½”ë“œ í‰ê°€\n    1. ì†ŒìŠ¤ì½”ë“œ í‰ê°€ ê³¼ì •ì´ ì‹¤í–‰ë˜ë©´ ë¨¼ì € ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•œë‹¤.\n    2. ë³€ìˆ˜ ë° í•¨ìˆ˜ì˜ ì„ ì–¸ë¬¸ë§Œ ë¨¼ì € ì‹¤í–‰í•˜ì—¬ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ê°€ ê´€ë¦¬í•˜ëŠ” ìŠ¤ì½”í”„( ë ‰ì‹œì»¬ í™˜ê²½ ìŠ¤ì½”í”„ )ì— ë“±ë¡í•œë‹¤.\n2. ì†ŒìŠ¤ì½”ë“œì˜ ì‹¤í–‰\n    1. ì†ŒìŠ¤ì½”ë“œ í‰ê°€ê°€ ì™„ë£Œë˜ë©´ ì„ ì–¸ë¬¸ì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ì†ŒìŠ¤ì½”ë“œê°€ ìˆœì°¨ì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤. ( = runtime)\n    2. ì´ë•Œ í•„ìš”í•œ ì‹¤í–‰ì •ë³´(ë³€ìˆ˜ ë° í•¨ìˆ˜ ê°’)ì€ í•´ë‹¹  ìŠ¤ì½”í”„ì—ì„œ ì·¨ë“í•œë‹¤.\n    3. ë³€ìˆ˜ë‚˜ í•¨ìˆ˜ì˜ ë³€ê²½ì´ ì¼ì–´ë‚˜ë©´ í•´ë‹¹ ìŠ¤ì½”í”„ì˜ ë³€ìˆ˜/í•¨ìˆ˜ë¥¼ ìˆ˜ì •í•œë‹¤.\n\n# ìë°”ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì»¨í…ìŠ¤íŠ¸ì˜ ì—­í• \n\n1. ì „ì—­ ì½”ë“œ í‰ê°€\n    1. ì „ì—­ë³€ìˆ˜, í•¨ìˆ˜ì„ ì–¸ë¬¸ì„ ì „ì—­ ê°ì²´ì˜ í”„ë¡œí¼í‹° ë° ë©”ì„œë“œë¡œ ë“±ë¡\n2. ì „ì—­ ì½”ë“œ ì‹¤í–‰\n    1. í•¨ìˆ˜ê°€ í˜¸ì¶œë˜ë©´ ì „ì—­ ì½”ë“œ ì‹¤í–‰ì„ ì¼ì‹œ ì¤‘ë‹¨í•˜ê³ , í•¨ìˆ˜ ë‚´ë¶€ë¡œ ì§„ì…\n3. í•¨ìˆ˜ ì½”ë“œ í‰ê°€\n    1. í•¨ìˆ˜ì˜ ì½”ë“œë¥¼ í‰ê°€í•˜ë©° í•„ìš”í•œ ê°’ë“¤ì„ í•¨ìˆ˜ ë‚´ë¶€ ìŠ¤ì½”í”„ì— ë“±ë¡\n4. í•¨ìˆ˜ ì½”ë“œ ì‹¤í–‰\n    1. í•¨ìˆ˜ ì½”ë“œ í‰ê°€ë¡œ ë“±ë¡ëœ ë³€ìˆ˜/í•¨ìˆ˜ë“¤ì„ ì´ìš©í•˜ì—¬ ì½”ë“œë¥¼ ì‹¤í–‰í•œë‹¤.","fileName":"2024-01-27","route":"2024-01-27"},"next":{"meta":{"title":"GraphQLì€ ë¬´ì—‡ì¸ê°€","desc":"GraphQLì— ëŒ€í•œ ê³µë¶€","date":"2024.01.29","tags":["Graph QL","ê·¸ë˜í”„ íì—˜"]},"content":"\n\u003e GraphQLì´ë€\n\n\u003caside\u003e\nğŸ’¡ GraphQLì€ ì¿¼ë¦¬ì–¸ì–´ì´ì ì„œë²„ì¸¡ ëŸ°íƒ€ì„\n\n\u003c/aside\u003e\n\nê·¸ë˜í”„ íì—˜ì€ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ”ë° ì¿¼ë¦¬ë¥¼ ì´ìš©í•˜ë„ë¡ í•©ë‹ˆë‹¤.\n\n\u003e runtime\n\ngraphQL apiëŠ” ì„œë²„ì—ì„œ runtimeì— ì‹¤í–‰ëœë‹¤.\n\në°ì´í„°ì˜ ì¶œì²˜ì— êµ¬ì• ë°›ì§€ ì•Šê³  runtimeì— ë°ì´í„° íŒ¨ì¹­ì´ ê°€ëŠ¥í•˜ë‹¤.\n\n\u003e GraphQL êµ¬í˜„ ìˆœì„œ\n\n1. GraphQL schema design\n2. resolver â†”Â data source connection\n3. GraphQL query fetching\n\n\u003e GraphQL ì˜ íŠ¹ì§•\n\n1. ì„±ëŠ¥\n   1. ì˜¤ë²„íŒ¨ì¹­ ë°©ì§€\n   2. ì–¸ë”íŒ¨ì¹­ ë°©ì§€: rest APIì˜ ê²½ìš° ì„œë¡œ ë‹¤ë¥¸ schema ë˜ëŠ” data sourceì˜ ê²½ìš° ì—¬ëŸ¬ë²ˆì˜ apiì½œë¡œ ê°ê° ì–¸ë”íŒ¨ì¹­ëœ ë°ì´í„°ë¥¼ front-sideì—ì„œ ì¡°í•©í•´ì•¼ í•˜ëŠ” ê²½ìš°ê°€ ìˆë‹¤. graphQLì€ ì´ëŸ° ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤.\n2. ê°œë°œì í¸ì˜ì„±\n   1. ê³„ì¸µì  ìŠ¤í‚¤ë§ˆ êµ¬ì¡°: ê·¸ë˜í”„ êµ¬ì¡°ì™€ ì„ ì–¸ì  êµ¬ì¡°ë¥¼ í†µí•´ ì¿¼ë¦¬ë¥¼ ì§ê´€ì ìœ¼ë¡œ ì´í•´í•  ìˆ˜ ìˆë‹¤.\n   2. íƒ€ì… ì•ˆì •ì„±: graphQLì€ ê·¸ ìì²´ë¡œ ìŠ¤í‚¤ë§ˆ êµ¬ì¡°ë¥¼ ê°€ì§€ë¯€ë¡œ í”„ë¡ íŠ¸ ì‚¬ì´ë“œì™€ ì„œë²„ ì‚¬ì´ë“œì˜ íƒ€ì…ì´ ìƒí˜¸ ë™ì¼í•´ì•¼ë§Œ í†µì‹ ì´ ê°€ëŠ¥í•˜ë¯€ë¡œ ê·¸ ìì²´ë¡œ íƒ€ì…ì•ˆì •ì„±ì„ ë³´ì¥í•œë‹¤.\n3. êµ¬ì¡°\n   1. í´ë¼ì´ì–¸íŠ¸ ê°œë°œì˜ ì„œë²„ ì˜ì¡´ì„± ë¶„ë¦¬: restAPIì²˜ëŸ¼ ì„œë²„ì‚¬ì´ë“œì—ì„œ ì›í•˜ëŠ” APIë¥¼ ê°œë°œí•´ ì¤„ ë•Œê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•˜ëŠ” ì—…ë¬´ì˜ì¡´ì„±ì„ ì—†ì•¨ ìˆ˜ ìˆë‹¤.\n   2. ë‹¨ì¼ ì •ë³´ì¶œì²˜: í”„ë¡ íŠ¸ ì‚¬ì´ë“œì—ì„  ë°ì´í„°ë“¤ ë§ˆë‹¤ APIë¥¼ ì–¸ë”íŒ¨ì¹­í•˜ì—¬ ì¡°í•©í•˜ë˜ restAPIì™€ ë‹¬ë¦¬ ì¡°í•©ì´ ë˜ì–´ ë¶ˆë ¤ì˜¤ë„ë¡ í•˜ëŠ” ë‹¨ì¼ ì¶œì²˜ë§Œ ì•Œë©´ëœë‹¤.\n4. í›Œë¥­í•œ ì»¤ë®¤ë‹ˆí‹°\n   1. í›Œë¥­í•œ ë„êµ¬ë“¤: apollo client, apollo studio ë“± ë‹¤ì–‘í•œ ë„êµ¬ë“¤ì´ ì™„ë¹„ë˜ì–´ìˆë‹¤.\n   2. ê´‘ë²”ìœ„í•œ ì´ìš©: ì—¬ëŸ¬ ì‚¬ì´íŠ¸ ë“¤ì—ì„œ graphQLì„ ì´ìš©ì¤‘ì´ë‹¤.\n","fileName":"2024-01-29","route":"2024-01-29"}},"__N_SSG":true},"page":"/posts/[postId]","query":{"postId":"2024-01-28"},"buildId":"Orm4NPDinx5N5dWCEtNLl","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>