---
title: 브라우저의 렌더링
desc: 브라우저의 렌더링 순서
date: 2024.02.02
tags: [브라우저, 렌더링, CSSOM, AST]
---

# 브라우저의 렌더링 순서

1. HTML, CSS, Javascript, static files 등의 리소스를 요청 하고 응답 받는다.
2. HTML, CSS를 파싱하여 DOM, CSSOM을 생성하여 렌더트리를 생성한다.
   1. DOM 파싱
      1. 서버에서 HTML을 바이트(2진수)형태로 응답받는다.
      2. meta tag의 charset 어트리뷰트를 통해 인코딩 방식을 인식하고 해당 인코딩 방식으로 문자열 치환한다.
      3. 해당 문자열을 문법적 최소 의미 단위를 갖는 토큰으로 분해한다.
      4. 분해된 토큰을 기반으로 노드 객체를 생성한다.
      5. 생성된 노드들은 트리구조로 되어있으며 이러한 구조를 DOM(Document Obejct Model)이라고 부른다.
   2. CSSOM 파싱
      1. DOM 생성( HTML 파싱 )중 link tag를 만나면 DOM 파싱을 중단한다.
      2. link태그에 지정된 href 로 요청을 보내 css 파일을 다운로드 한다.
      3. 다운받은 css파일을 DOM파싱과 동일한 과정을 거쳐 tree 구조의 객체들로 만들고 그것을 CSSOM(CSS Object Model)이라고 부른다.
   3. 렌더트리
      1. DOM과 CSSOM을 렌더트리로 결합한다.
      2. 화면에 렌더링 되지 않는 태그( = script, link 및 css에 의해 비표출 되는 노드들)은 제외된다.
      3. 생성된 렌더트리는 요소들의 레이아웃 계산에 사용되며 이를 통해 페인팅을 실행한다.
3. 자바스크립트를 파싱하여 AST(Absctract Syntax Tree)를 생성하고, 바이트 코드로 변환하여 실행한다.
   1. 자바스크립트의 파싱
      1. DOM 생성 과정에서 script태그를 만나면 DOM 파싱을 중단하고 js를 파싱한다.
      2. 파싱은 자바스크립트 엔진(V8, spiderMonkey, javaScriptCore 등)에서 일어난다.
      3. 제어권을 넘겨받은 자바스크립트 엔진은 AST(Abstract Syntax Tree)를 생성한다.
   2. 자바스크립트 소스 파싱의 순서
      1. 토크나이징 : 토크나이저가 자바스크립트 소스를 토큰 단위로 분해한다.
      2. 파싱 : 토큰들을 분석하여 AST를 생헌한다.
      3. 바이트코드 생성 : AST를 인터프리터가 실행할 수 있는 바이트 코드로 변환 한다.
         1. V8의 경우 자주 실행되는 코드는 터보팬(컴파일러)에 의해 Optimized Machine Code로 컴파일 되어 성능 최적화를 진행하며, 사용 빈도가 적어지만 Deoptimizing한다.
      4. 실행 : 인터프리터가 바이트코드를 읽어 로직을 실행한다.
4. 렌더트리를 기반으로 HTML요소의 레이아웃을 계산하고 브라우저 화면에 페인팅한다.

### Reference

- 자바스크립트 딥 다이브 (38장)
